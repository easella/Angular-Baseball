!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_baseballUtilityLog=require("baseball/Utility/Log"),AtBat=function(){function AtBat(text){_classCallCheck(this,AtBat),this.infield=text.indexOf(AtBat.prototype.INFIELD_HIT_INDICATOR)>-1?AtBat.prototype.INFIELD_HIT_INDICATOR:"",text=text.replace(AtBat.prototype.INFIELD_HIT_INDICATOR,""),this.text=text.split(AtBat.prototype.RBI_INDICATOR)[0],this.rbi=text.split(this.text)[1]+"";var log=new _baseballUtilityLog.Log,beneficial=[log.WALK,log.SINGLE,log.HOMERUN,log.DOUBLE,log.TRIPLE,log.SACRIFICE,log.REACHED_ON_ERROR,log.STOLEN_BASE,log.RUN];beneficial.indexOf(this.text)>-1&&(this.beneficial=!0)}return _createClass(AtBat,[{key:"toString",value:function(){return""+this.infield+this.text+this.rbi}}]),AtBat}();AtBat.prototype.constructor=AtBat,AtBat.prototype.identifier="AtBat",AtBat.prototype.INFIELD_HIT_INDICATOR="",AtBat.prototype.RBI_INDICATOR="+",exports.AtBat=AtBat},{"baseball/Utility/Log":32}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _baseballModelPlayer=require("baseball/Model/Player"),_baseballServices_services=require("baseball/Services/_services"),Field=function(game){this.init(game)};Field.prototype={constructor:Field,init:function(game){this.game=game,this.first=null,this.second=null,this.third=null},hasRunnersOn:function(){return this.first instanceof _baseballModelPlayer.Player||this.second instanceof _baseballModelPlayer.Player||this.third instanceof _baseballModelPlayer.Player},determineSwingContactResult:function(swing){this.first&&(this.first.fatigue+=4),this.second&&(this.second.fatigue+=4),this.third&&(this.third.fatigue+=4);var x=swing.x,y=swing.y,eye=this.game.batter.skill.offense.eye,angles=_baseballServices_services.Mathinator.getSplayAndFlyAngle(x,y,swing.angle,eye),splayAngle=angles.splay,flyAngle=angles.fly,power=this.game.batter.skill.offense.power+(this.game.batter.eye.bonus||0)/5,landingDistance=_baseballServices_services.Distribution.landingDistance(power,flyAngle,x,y);0>flyAngle&&landingDistance>95&&(landingDistance=(landingDistance-95)/4+95);var game=this.game;if(Math.abs(splayAngle)>50&&(swing.foul=!0),swing.fielder=this.findFielder(splayAngle,landingDistance,power,flyAngle),landingDistance=["first","second","short","third"].indexOf(swing.fielder)>-1?Math.min(landingDistance,110):Math.max(landingDistance,150),swing.travelDistance=landingDistance,swing.flyAngle=flyAngle,swing.splay=splayAngle,swing.sacrificeAdvances=[],swing.fielder){var fielder="top"==game.half?game.teams.home.positions[swing.fielder]:game.teams.away.positions[swing.fielder];fielder.fatigue+=4,swing.error=!1;var fieldingEase=fielder.skill.defense.fielding/100,throwingEase=fielder.skill.defense.throwing/100;swing.fielderTravel=this.getPolarDistance(this.positions[swing.fielder],[splayAngle+90,landingDistance]);var interceptRating=1.8*fielder.skill.defense.speed+2.4*flyAngle-1.55*swing.fielderTravel-15;if(interceptRating>0&&flyAngle>4){if(_baseballServices_services.Distribution.error(fielder))fieldingEase*=.5,swing.error=!0,fielder.stats.fielding.E++,swing.caught=!1;else if(fielder.stats.fielding.PO++,swing.caught=!0,game.umpire.count.outs<2){var sacrificeThrowInTime=_baseballServices_services.Mathinator.fielderReturnDelay(swing.travelDistance,throwingEase,fieldingEase,100);this.first&&sacrificeThrowInTime>this.first.getBaseRunningTime()+4.5&&swing.sacrificeAdvances.push("first"),this.second&&sacrificeThrowInTime>this.second.getBaseRunningTime()&&swing.sacrificeAdvances.push("second"),this.third&&sacrificeThrowInTime>this.third.getBaseRunningTime()-.5&&swing.sacrificeAdvances.push("third")}}else swing.caught=!1;if(!swing.caught){swing.bases=0,swing.thrownOut=!1;var fieldingReturnDelay=_baseballServices_services.Mathinator.fielderReturnDelay(swing.travelDistance,throwingEase,fieldingEase,interceptRating);swing.fieldingDelay=fieldingReturnDelay,swing.outfielder=1=={left:1,center:1,right:1}[swing.fielder];var speed=game.batter.skill.offense.speed,baseRunningTime=_baseballServices_services.Mathinator.baseRunningTime(speed);if(swing.outfielder)for(swing.bases=1,baseRunningTime*=1.05,fieldingReturnDelay-=baseRunningTime;(fieldingReturnDelay>baseRunningTime&&Math.random()<.25+speed/200||Math.random()<.04+speed/650)&&swing.bases<3;)baseRunningTime*=.95,swing.bases++,fieldingReturnDelay-=baseRunningTime;else{var first=this.first,second=this.second,third=this.third;swing.fieldersChoice=null,swing.bases=fieldingReturnDelay>=baseRunningTime+1?1:0,first&&fieldingReturnDelay<first.getBaseRunningTime()&&(swing.fieldersChoice="first"),first&&second&&fieldingReturnDelay<second.getBaseRunningTime()+.6&&(swing.fieldersChoice="second"),third&&fieldingReturnDelay<third.getBaseRunningTime()&&(swing.fieldersChoice="third");var outs=game.umpire.count.outs;if(swing.fieldersChoice){outs++,swing.bases=1;var fielders=fielder.team.positions,force=this.forcePlaySituation();if(force){var additionalOuts=[],throwingDelay=fieldingReturnDelay;third&&"third"===force&&_baseballServices_services.Mathinator.infieldThrowDelay(fielders.catcher)+throwingDelay<second.getBaseRunningTime()&&3>outs&&(throwingDelay+=_baseballServices_services.Mathinator.infieldThrowDelay(fielders.catcher),fielders.catcher.fatigue+=4,additionalOuts.push("second"),outs++,force="second"),second&&"second"===force&&_baseballServices_services.Mathinator.infieldThrowDelay(fielders.third)+throwingDelay<first.getBaseRunningTime()&&3>outs&&(throwingDelay+=_baseballServices_services.Mathinator.infieldThrowDelay(fielders.third),fielders.third.fatigue+=4,additionalOuts.push("first"),outs++,force="first"),first&&"first"===force&&_baseballServices_services.Mathinator.infieldThrowDelay(fielders.second)+throwingDelay<game.batter.getBaseRunningTime()&&3>outs&&(throwingDelay+=_baseballServices_services.Mathinator.infieldThrowDelay(fielders.second),fielders.second.fatigue+=4,additionalOuts.push("batter"),swing.bases=0,outs++),outs-game.umpire.count.outs===2&&(swing.doublePlay=!0),additionalOuts.length&&(swing.additionalOuts=additionalOuts,swing.firstOut=swing.fieldersChoice,additionalOuts.indexOf("batter")>-1&&delete swing.fieldersChoice)}}else delete swing.additionalOuts,delete swing.firstOut,delete swing.doublePlay,delete swing.fieldersChoice}swing.thrownOut=0==swing.bases,swing.thrownOut&&(fielder.stats.fielding.PO++,swing.thrownOut=!0,swing.error=!1)}}else Math.abs(splayAngle)<45&&landingDistance>300?swing.bases=4:(swing.foul=!0,swing.caught=!1);this.game.swingResult=swing,_baseballServices_services.Animator.console||(_baseballServices_services.Animator._ball.hasIndicator=!0,_baseballServices_services.Animator.animateFieldingTrajectory(this.game))},forcePlaySituation:function(){var first=this.first,second=this.second,third=this.third;return first&&second&&third&&"third"||first&&second&&"second"||first&&"first"},getLeadRunner:function(){var first=this.first,second=this.second,third=this.third;return third&&first&&!second?first:third||second||first},findFielder:function(splayAngle,landingDistance,power,flyAngle){var fielder,angle=splayAngle;if(Math.abs(angle)>50)return!1;if(10>landingDistance&&landingDistance>-20)return"catcher";if(landingDistance>=10&&45>landingDistance&&Math.abs(angle)<5)return"pitcher";var infield=landingDistance<145-Math.abs(angle)/90*50;if(7>flyAngle){var horizontalVelocity=Math.cos(flyAngle/180*Math.PI)*(85+power/100*10);0>flyAngle&&(horizontalVelocity*=.5);var fielderLateralReachDegrees=1+22.5*(100-horizontalVelocity)/100;fielder=-20>angle?"third":5>angle?"short":30>angle?"second":"first";var fielderArcPosition=this.positions[fielder][0]-90;infield=Math.abs(angle-fielderArcPosition)<fielderLateralReachDegrees}return fielder=infield&&landingDistance>15?-20>angle?"third":5>angle?"short":30>angle?"second":"first":310>landingDistance?-15>angle?"left":16>angle?"center":"right":!1},positions:{pitcher:[90,66],catcher:[0,0],first:[128,98],second:[102.5,130],"short":[77.5,130],third:[52,98],left:[59,280],center:[90,280],right:[121,280]},getPolarDistance:function(a,b){return _baseballServices_services.Mathinator.getPolarDistance(a,b)},fieldingTest:function(){var angle=90*Math.random()+45,distance=320*Math.random(),fielder=this.findFielder(angle,distance),data={};if(fielder){var fielderCandidates=this.fielderSelectionTest(angle,distance,!0);return data.fielder=fielderCandidates[1],data[fielderCandidates[0]]=this.getPolarDistance([angle,distance],[this.positions[fielderCandidates[0]][0],this.positions[fielderCandidates[0]][1]]),data[fielderCandidates[1]]=this.getPolarDistance([angle,distance],[this.positions[fielderCandidates[1]][0],this.positions[fielderCandidates[1]][1]]),data}},aggregateFieldingTest:function(){for(var fielders={pitcher:{tally:0,distances:[]},catcher:{tally:0,distances:[]},first:{tally:0,distances:[]},second:{tally:0,distances:[]},"short":{tally:0,distances:[]},third:{tally:0,distances:[]},left:{tally:0,distances:[]},center:{tally:0,distances:[]},right:{tally:0,distances:[]},"false":{tally:0,distances:[]}},selections=[],i=0;1e3>i;i++){var angle=90*Math.random()+45,distance=320*Math.random(),fielder=this.findFielder(angle,distance);fielders[fielder].tally++,fielder&&fielders[fielder].distances.push(this.getPolarDistance([angle,distance],[this.positions[fielder][0],this.positions[fielder][1]])),selections.push([angle,distance]),selections.push(this.fielderSelectionTest(angle,distance,!0))}return[fielders,selections]},fielderSelectionTest:function(angle,distance,returnFielder){var distances=[],minDistance=300,giraffe=this,fielder=!1;return Iterator.each(this.positions,function(position,spot){var thisDistance=giraffe.getPolarDistance([angle,distance],spot);distances[thisDistance]=position,minDistance>thisDistance&&(minDistance=thisDistance,fielder=position)}),returnFielder?[fielder,this.findFielder(angle,distance)]:distances}},exports.Field=Field},{"baseball/Model/Player":5,"baseball/Services/_services":28}],3:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _baseballModelField=require("baseball/Model/Field"),_baseballModelTeam=require("baseball/Model/Team"),_baseballModelUmpire=require("baseball/Model/Umpire"),_baseballModelPlayer=require("baseball/Model/Player"),_baseballUtilityLog=require("baseball/Utility/Log"),_baseballUtility_utils=require("baseball/Utility/_utils"),_baseballServices_services=require("baseball/Services/_services"),Game=function(m){this.init(m)};Game.prototype={constructor:Game,gamesIntoSeason:0,humanControl:"home",console:!1,quickMode:!0,debug:[],pitcher:{},batter:{},init:function(m){for(this.reset(),this.startTime={h:8*Math.random()+10|0,m:60*Math.random()|0},this.timeOfDay={h:this.startTime.h,m:this.startTime.m},m&&(_baseballUtility_utils.text.mode=m),this.gamesIntoSeason=5+Math.floor(133*Math.random()),this.field=new _baseballModelField.Field(this),this.teams.away=new _baseballModelTeam.Team(this),this.teams.home=new _baseballModelTeam.Team(this),this.log=new _baseballUtilityLog.Log,this.log.game=this,this.debug=[],this.helper=_baseballUtility_utils.helper;this.teams.away.name==this.teams.home.name;)this.teams.away.pickName();this.umpire=new _baseballModelUmpire.Umpire(this),this.humanPitching()&&(this.stage="pitch"),this.autoPitchSelect(),_baseballServices_services.Animator.init(),_baseballServices_services.Animator.console||_baseballServices_services.Animator.loop.setTimeOfDay(0,0)},passMinutes:function(minutes){var time=this.timeOfDay;for(time.m=parseInt(time.m),time.m+=parseInt(minutes);time.m>=60;)time.m=parseInt(time.m)-60,time.h=(parseInt(time.h)+1)%24;_baseballServices_services.Animator.console||_baseballServices_services.Animator.loop.setTargetTimeOfDay(time.h,time.m)},getInning:function(){return"n"==_baseballUtility_utils.text.mode?this.inning+("top"==this.half?"オモテ":"ウラ"):this.half.toUpperCase()+" "+this.inning},humanBatting:function(){var humanControl=this.humanControl;if("none"==humanControl)return!1;switch(this.half){case"top":return"both"==humanControl||"away"==humanControl;case"bottom":return"both"==humanControl||"home"==humanControl}},humanPitching:function(){var humanControl=this.humanControl;if("none"==humanControl)return!1;switch(this.half){case"top":return"both"==humanControl||"home"==humanControl;case"bottom":return"both"==humanControl||"away"==humanControl}},end:function(){this.stage="end";var e,n;e=this.tally.home.R>this.tally.away.R?"Home team wins!":this.tally.home.R==this.tally.away.R?"You tied. Yes, you can do that.":"Visitors win!",n=this.tally.home.R>this.tally.away.R?this.teams.home.getName()+"の勝利":this.tally.home.R==this.tally.away.R?"引き分け":this.teams.away.getName()+"の勝利",this.tally.home.R>this.tally.away.R?(this.teams.home.positions.pitcher.stats.pitching.W++,this.teams.away.positions.pitcher.stats.pitching.L++):this.tally.home.R<this.tally.away.R&&(this.teams.home.positions.pitcher.stats.pitching.L++,this.teams.away.positions.pitcher.stats.pitching.W++),this.log.note(e,n),this.log.note("Reload to play again","リロるは次の試合へ")},stage:"pitch",simulateInput:function(callback){var stage=this.stage,pitchTarget=this.pitchTarget;"end"!=stage&&("pitch"==stage?this.autoPitch(callback):"swing"==stage&&("object"!=typeof pitchTarget&&(this.pitchTarget={x:100,y:100}),this.autoSwing(this.pitchTarget.x,this.pitchTarget.y,callback)))},simulatePitchAndSwing:function(callback){if("end"!=this.stage){this.autoPitch(callback);var giraffe=this;setTimeout(function(){"object"!=typeof giraffe.pitchTarget&&(giraffe.pitchTarget={x:100,y:100}),giraffe.autoSwing(giraffe.pitchTarget.x,giraffe.pitchTarget.y,function(callback){callback()})},giraffe.field.hasRunnersOn()?_baseballServices_services.Animator.TIME_FROM_SET+2500:_baseballServices_services.Animator.TIME_FROM_WINDUP+2500)}},receiveInput:function(x,y,callback){"none"!=this.humanControl&&"end"!=this.stage&&("pitch"==this.stage&&this.humanPitching()?this.thePitch(x,y,callback):"swing"==this.stage&&this.humanBatting()&&this.theSwing(x,y,callback))},autoPitchSelect:function(){var pitchNames=Object.keys(this.pitcher.pitching),pitchName=pitchNames[Math.random()*pitchNames.length|0],pitch=this.pitcher.pitching[pitchName];pitch.name=pitchName,this.pitchInFlight=pitch},autoPitch:function(callback){var pitcher=this.pitcher,giraffe=this;if("pitch"==this.stage){if(this.autoPitchSelect(),pitcher.windingUp=!0,!this.console){$(".baseball").addClass("hide");var windup=$(".windup");windup.css("width","100%")}var count=this.umpire.count,pitch=_baseballServices_services.Distribution.pitchLocation(count),x=pitch.x,y=pitch.y;this.quickMode?this.thePitch(x,y,callback):(_baseballServices_services.Animator.console||_baseballServices_services.Animator.loop.resetCamera(),windup.animate({width:0},this.field.hasRunnersOn()?_baseballServices_services.Animator.TIME_FROM_SET:_baseballServices_services.Animator.TIME_FROM_WINDUP,function(){!giraffe.console&&$(".baseball.pitch").removeClass("hide"),giraffe.thePitch(x,y,callback),pitcher.windingUp=!1}))}},autoSwing:function(deceptiveX,deceptiveY,callback){var convergence,convergenceSum,giraffe=this,bonus=this.batter.eye.bonus||0,eye=this.batter.skill.offense.eye+6*(this.umpire.count.balls+this.umpire.count.strikes)+bonus,x=_baseballServices_services.Distribution.centralizedNumber(),y=_baseballServices_services.Distribution.centralizedNumber();100*Math.random()<eye&&(deceptiveX=this.pitchInFlight.x,deceptiveY=this.pitchInFlight.y),100*Math.random()<eye?(convergence=eye/25,convergenceSum=1+convergence):(convergence=eye/100,convergenceSum=1+convergence),x=(deceptiveX*convergence+x)/convergenceSum,y=(deceptiveY*convergence+y)/convergenceSum,this.swingResult.x=_baseballServices_services.Distribution.cpuSwing(x,this.pitchInFlight.x,eye),this.swingResult.y=_baseballServices_services.Distribution.cpuSwing(y,this.pitchInFlight.y,.75*eye);var swingProbability=_baseballServices_services.Distribution.swingLikelihood(eye,x,y,this.umpire);swingProbability<100*Math.random()&&(x=-20),callback(function(){giraffe.theSwing(x,y)})},opponentConnected:!1,waitingCallback:function(){},awaitPitch:function(callback,swingResult){var giraffe=this;this.opponentConnected?(this.waitingCallback=callback,this.opponentService.emitSwing(swingResult)):setTimeout(function(){giraffe.autoPitch(callback)},5200)},awaitSwing:function(x,y,callback,pitchInFlight,pitchTarget){this.opponentConnected?(this.waitingCallback=callback,this.opponentService.emitPitch({inFlight:pitchInFlight,target:pitchTarget})):this.autoSwing(x,y,callback)},thePitch:function(x,y,callback,override){var pitch=this.pitchInFlight;if("pitch"==this.stage){if(override)this.pitchInFlight=override.inFlight,this.pitchTarget=override.target,callback=this.waitingCallback;else{this.pitcher.fatigue++,this.pitchTarget.x=x,this.pitchTarget.y=y,pitch.breakDirection=this.helper.pitchDefinitions[pitch.name].slice(0,2),this.battersEye=_baseballUtility_utils.text.getBattersEye(this);var control=Math.floor(pitch.control-this.pitcher.fatigue/2);this.pitchTarget.x=_baseballServices_services.Distribution.pitchControl(this.pitchTarget.x,control),this.pitchTarget.y=_baseballServices_services.Distribution.pitchControl(this.pitchTarget.y,control),"right"==this.pitcher["throws"]&&(pitch.breakDirection[0]*=-1);var breakEffect=_baseballServices_services.Distribution.breakEffect(pitch,this.pitcher,this.pitchTarget.x,this.pitchTarget.y);pitch.x=breakEffect.x,pitch.y=breakEffect.y}this.log.notePitch(pitch,this.batter),this.stage="swing","none"==this.humanControl||"both"!=this.humanControl&&!this.humanBatting()?this.awaitSwing(x,y,callback,pitch,this.pitchTarget):callback()}},battersEye:{e:"",n:""},theSwing:function(x,y,callback,override){var pitch=this.pitchInFlight;if("swing"==this.stage){if(override){var result=this.swingResult=override;callback=this.waitingCallback}else{this.swingResult=result={};var bonus=this.batter.eye.bonus||0,eye=this.batter.skill.offense.eye+6*(this.umpire.count.balls+this.umpire.count.strikes)+bonus;if(x>=0&&200>=x){this.batter.fatigue++,result.x=x-pitch.x,result.y=y-pitch.y,result.angle=this.setBatAngle();var recalculation=_baseballServices_services.Mathinator.getAngularOffset(result,result.angle),precision=_baseballServices_services.Distribution.swing(eye);result.x=recalculation.x*precision,result.y=-5+recalculation.y*precision,result.looking=!1,Math.abs(result.x)<60&&Math.abs(result.y)<35?(result.contact=!0,this.field.determineSwingContactResult(result),this.debug.push(result)):result.contact=!1}else result.strike=pitch.x>50&&pitch.x<150&&pitch.y>35&&pitch.y<165,this.batter.eye.bonus=Math.max(0,eye-1.5*Math.sqrt(Math.pow(this.batter.eye.x-pitch.x,2)+Math.pow(this.batter.eye.y-pitch.y,2))),result.contact=!1,result.looking=!0,this.batter.eye.x=pitch.x,this.batter.eye.y=pitch.y}var field=this.field,team=this.batter.team;if((team.stealAttempt===_baseballModelTeam.Team.RUNNER_GO||team.stealAttempt===_baseballModelTeam.Team.RUNNERS_DISCRETION)&&!this.opponentConnected){var thief=field.getLeadRunner();if(thief instanceof _baseballModelPlayer.Player){switch(thief){case field.first:var base=2;break;case field.second:base=3;break;case field.third:base=4}var validToSteal=!0;if(result.looking){var count=this.umpire.count;count.strikes>=2&&result.strike&&count.outs>=2&&(validToSteal=!1),count.balls>=3&&!result.strike&&field.first&&(validToSteal=!1)}(result.foul||result.caught)&&(validToSteal=!1);var discretion="go"===team.stealAttempt||_baseballServices_services.Distribution.willSteal(pitch,this.pitcher.team.positions.catcher,thief,base);discretion&&validToSteal&&thief.attemptSteal(this,base),team.stealAttempt=_baseballModelTeam.Team.RUNNERS_DISCRETION}}this.log.noteSwing(result),this.stage="pitch";var half=this.half;if(this.umpire.makeCall(),emit=!1,half!=this.half){callback=this.startOpponentPitching;var emit=!override}"function"==typeof callback&&("none"==this.humanControl||"both"!=this.humanControl&&this.teams[this.humanControl]!=this.pitcher.team?this.awaitPitch(callback,result):(callback(),emit&&this.opponentService&&this.opponentConnected&&this.opponentService.emitSwing(result)))}},setBatAngle:function(x,y){var giraffe=this,pitchInFlight=this.pitchInFlight,swingResult=this.swingResult,origin={x:"right"==giraffe.batter.bats?-10:210,y:199},swing={x:x?x:pitchInFlight.x+swingResult.x,y:y?y:pitchInFlight.y+swingResult.y};return _baseballServices_services.Mathinator.battingAngle(origin,swing)},debugOut:function(){log("slugging",this.debug.filter(function(a){return 1==a.bases}).length,this.debug.filter(function(a){return 2==a.bases}).length,this.debug.filter(function(a){return 3==a.bases}).length,this.debug.filter(function(a){return 4==a.bases}).length),log("grounders",this.debug.filter(function(a){return!a.caught&&!a.foul&&a.flyAngle<0}).length,"thrown out",this.debug.filter(function(a){return!a.caught&&!a.foul&&a.flyAngle<0&&a.thrownOut}).length),log("flies/liners",this.debug.filter(function(a){return!a.foul&&a.flyAngle>0}).length,"caught",this.debug.filter(function(a){return a.caught&&a.flyAngle>0}).length);var PO={};this.debug.map(function(a){a.fielder&&(PO[a.fielder]||(PO[a.fielder]=0),!a.bases&&a.fielder&&PO[a.fielder]++)}),log("fielding outs",JSON.stringify(PO));var hitters=this.teams.away.lineup.concat(this.teams.home.lineup),atBats=[];hitters.map(function(a){atBats=atBats.concat(a.getAtBats().map(function(ab){return ab.text}))});var LO=atBats.filter(function(ab){return"LO"==ab}).length,FO=atBats.filter(function(ab){return"FO"==ab}).length,GO=atBats.filter(function(ab){return"GO"==ab}).length,GIDP=atBats.filter(function(ab){return"(IDP)"==ab}).length,SO=atBats.filter(function(ab){return"SO"==ab}).length,BB=atBats.filter(function(ab){return"BB"==ab}).length,SAC=atBats.filter(function(ab){return"SAC"==ab}).length,FC=atBats.filter(function(ab){return"FC"==ab}).length,CS=atBats.filter(function(ab){return"CS"==ab}).length,SB=atBats.filter(function(ab){return"SB"==ab}).length;log("line outs",LO,"fly outs",FO,"groundouts",GO,"strikeouts",SO,"sacrifices",SAC,"FC",FC,"gidp",GIDP,"CS",CS,"total",LO+FO+GO+SO+SAC+FC+GIDP+CS),log("BB",BB,"SB",SB),log("fouls",this.debug.filter(function(a){return a.foul}).length),log("fatigue, home vs away");var teams=this.teams,fatigue={home:{},away:{}};_baseballServices_services.Iterator.each(this.teams.home.positions,function(key){var position=key;fatigue.home[position]=teams.home.positions[position].fatigue,fatigue.away[position]=teams.away.positions[position].fatigue}),console.table(fatigue),console.table(this.scoreboard),console.table(this.tally)},toData:function(){var data={};data.half=this.half,data.inning=this.inning,data.tally=this.tally;var giraffe=this,players=this.teams.away.lineup.concat(this.teams.home.lineup);return data.field={first:players.indexOf(this.field.first),second:players.indexOf(this.field.second),third:players.indexOf(this.field.third)},data.batter=players.indexOf(this.batter),data.deck=players.indexOf(this.deck),data.hole=players.indexOf(this.hole),data.teams={home:{name:giraffe.teams.home.name,nameJ:giraffe.teams.home.nameJ},away:{name:giraffe.teams.away.name,nameJ:giraffe.teams.away.nameJ}},data.umpire={says:giraffe.umpire.says,count:{strikes:giraffe.umpire.count.strikes,balls:giraffe.umpire.count.balls,outs:giraffe.umpire.count.outs}},data.players=players.map(function(player){return player.serialize()}),data.log={pitchRecord:giraffe.log.pitchRecord,record:giraffe.log.record},data.gamesIntoSeason=this.gamesIntoSeason,data},fromData:function(data){this.half=data.half,this.inning=data.inning,this.tally=data.tally;var giraffe=this,players=data.players.map(function(playerJson,index){var playerData=JSON.parse(playerJson);if(index>8){var side="home";index-=9}else side="away";var player=giraffe.teams[side].positions[playerData.position];return player.fromData(playerData),giraffe.teams[side].lineup[index]=player,player.resetStats(data.gamesIntoSeason),player});return this.field.first=players[data.field.first],this.field.second=players[data.field.second],this.field.third=players[data.field.third],this.batter=players[data.batter],this.deck=players[data.deck],this.hole=players[data.hole],this.umpire.says=data.umpire.says,this.umpire.count=data.umpire.count,this.teams.away.name=data.teams.away.name,this.teams.away.nameJ=data.teams.away.nameJ,this.teams.home.name=data.teams.home.name,this.teams.home.nameJ=data.teams.home.nameJ,this.log.pitchRecord=data.log.pitchRecord,this.log.record=data.log.record,this.log.stabilizeShortRecord(),this.gamesIntoSeason=data.gamesIntoSeason,this},startOpponentPitching:null,pitchTarget:{x:100,y:100},pitchInFlight:{x:100,y:100,breakDirection:[0,0],name:"slider",velocity:50,"break":50,control:50},swingResult:{x:100,y:100,strike:!1,foul:!1,caught:!1,contact:!1,looking:!0,bases:0,fielder:"short",outs:0},playResult:{batter:"",fielder:""},showPlayResultPanels:function(batter){var batterOutcomes={},atBat=batter.atBats.slice(0).pop(),fielderOutcomes={},n=function n(){var n=Math.floor(3*Math.random());return n?n:""};this.playResult={batter:"B_placeholder"+n()||batterOutcomes[atBat]||"batter/"+atBat,fielder:"F_placeholder"+n()||fielderOutcomes[atBat]||"fielder/"+atBat}},pitchSelect:function(){},field:null,teams:{away:null,home:null},log:null,half:"top",inning:1,scoreboard:{away:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0},home:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0}},reset:function(){this.scoreboard={away:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0},home:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0}},this.resetTally()},resetTally:function(){this.tally={away:{H:0,R:0,E:0},home:{H:0,R:0,E:0}}},tally:{away:{H:0,R:0,E:0},home:{H:0,R:0,E:0}}},exports.Game=Game},{"baseball/Model/Field":2,"baseball/Model/Player":5,"baseball/Model/Team":6,"baseball/Model/Umpire":7,"baseball/Services/_services":28,"baseball/Utility/Log":32,"baseball/Utility/_utils":33}],4:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _baseballServices_services=require("baseball/Services/_services"),Manager=function(team){this.init(team)};Manager.prototype={constructor:Manager,init:function(team){this.team=team},makeLineup:function(){var jerseyNumber=1;this.team.positions.pitcher=this.selectForSkill(this.team.bench,["pitching"]),this.team.positions.pitcher.position="pitcher",this.team.positions.pitcher.number||(this.team.positions.pitcher.number=jerseyNumber++),this.team.positions.catcher=this.selectForSkill(this.team.bench,["defense","catching"],"right"),this.team.positions.catcher.position="catcher",this.team.positions.catcher.number||(this.team.positions.catcher.number=jerseyNumber++),_baseballServices_services.Iterator.each(this.team.bench,function(key,player){player.number||(player.number=jerseyNumber++)}),this.team.positions["short"]=this.selectForSkill(this.team.bench,["defense","fielding"],"right"),this.team.positions["short"].position="short",this.team.positions.second=this.selectForSkill(this.team.bench,["defense","fielding"],"right"),this.team.positions.second.position="second",this.team.positions.third=this.selectForSkill(this.team.bench,["defense","fielding"],"right"),this.team.positions.third.position="third",this.team.positions.center=this.selectForSkill(this.team.bench,["defense","speed"]),this.team.positions.center.position="center",this.team.positions.left=this.selectForSkill(this.team.bench,["defense","speed"]),this.team.positions.left.position="left",this.team.positions.right=this.selectForSkill(this.team.bench,["defense","speed"]),this.team.positions.right.position="right",this.team.positions.first=this.selectForSkill(this.team.bench,["defense","fielding"],"left"),this.team.positions.first.position="first",this.team.lineup[3]=this.selectForSkill(this.team.positions,["offense","power"]),this.team.lineup[3].order=3,this.team.lineup[2]=this.selectForSkill(this.team.positions,["offense","power"]),this.team.lineup[2].order=2,this.team.lineup[4]=this.selectForSkill(this.team.positions,["offense","power"]),this.team.lineup[4].order=4,this.team.lineup[0]=this.selectForSkill(this.team.positions,["offense","speed"]),this.team.lineup[0].order=0,this.team.lineup[1]=this.selectForSkill(this.team.positions,["offense","eye"]),this.team.lineup[1].order=1,this.team.lineup[5]=this.selectForSkill(this.team.positions,["offense","eye"]),this.team.lineup[5].order=5,this.team.lineup[6]=this.selectForSkill(this.team.positions,["offense","eye"]),this.team.lineup[6].order=6,this.team.lineup[7]=this.selectForSkill(this.team.positions,["offense","eye"]),this.team.lineup[7].order=7,this.team.lineup[8]=this.selectForSkill(this.team.positions,["offense","speed"]),this.team.lineup[8].order=8},selectForSkill:function(pool,skillset,requiredThrowingHandedness){if(this.team.bench.length||pool==this.team.positions){var selection=this.team.bench[0],rating=0,index=0;return _baseballServices_services.Iterator.each(pool,function(key,player){for(var skills=skillset.slice(),cursor=player.skill,property=skills.shift();property;)cursor=cursor[property],property=skills.shift();player.order+1||!(cursor>=rating)||requiredThrowingHandedness&&player["throws"]!=requiredThrowingHandedness||(rating=cursor,selection=player,index=key)}),pool==this.team.bench&&(delete this.team.bench[index],this.team.bench=this.team.bench.filter(function(player){return player instanceof selection.constructor})),selection}return"no players available"}},exports.Manager=Manager},{"baseball/Services/_services":28}],5:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _baseballUtility_utils=require("baseball/Utility/_utils"),_baseballServices_services=require("baseball/Services/_services"),_baseballModel_models=require("baseball/Model/_models"),Player=function(team){this.init(team),this.resetStats(this.team.game&&this.team.game.gamesIntoSeason||0)};Player.prototype={constructor:Player,init:function(team,hero){this["throws"]=Math.random()>.86?"left":"right",this.bats=Math.random()>.75?"left":"right",this.team=team,this.skill={},this.eye={x:100,y:100},this.pitching={averaging:[]},this.number=0,this.randomizeSkills(hero||Math.random()>.9);var surnameKey=Math.floor(Math.random()*_baseballUtility_utils.data.surnames.length),nameKey=Math.floor(Math.random()*_baseballUtility_utils.data.names.length);this.name=_baseballUtility_utils.data.surnames[surnameKey]+" "+_baseballUtility_utils.data.names[nameKey];var jSurname=_baseballUtility_utils.data.surnamesJ[surnameKey],jGivenName=_baseballUtility_utils.data.namesJ[nameKey];this.spaceName(jSurname,jGivenName),this.surname=_baseballUtility_utils.data.surnames[surnameKey],this.surnameJ=_baseballUtility_utils.data.surnamesJ[surnameKey],this.atBats=[]},spaceName:function(jSurname,jGivenName){1==jSurname.length&&jGivenName.length<=2&&(jSurname+="・"),1==jGivenName.length&&jSurname.indexOf("・")<0&&jSurname.length<=2&&(jSurname+="・"),this.nameJ=jSurname+jGivenName,this.surnameJ=jSurname;
},serialize:function(){var team=this.team;delete this.team;var data=JSON.stringify(this);return this.team=team,data},fromData:function(data){var giraffe=this;_baseballServices_services.Iterator.each(data,function(key,value){giraffe[key]=value}),delete this.atBatObjects,this.getAtBats()},substitute:function(player){if(player.team!==this.team)return!1;var order=player.order,position=player.position;player.team.substituted.push(player),player.team.positions[position]=this,player.team.lineup[order]=this,this.position=position,this.order=order;var game=this.team.game;game.pitcher===player&&(game.pitcher=this),game.batter===player&&(game.batter=this),game.deck===player&&(game.deck=this),game.hole===player&&(game.hole=this);var field=game.field;field.first===player&&(field.first=this),field.second===player&&(field.second=this),field.third===player&&(field.third=this);var bench=this.team.bench,bullpen=this.team.bullpen;bench.indexOf(this)>-1&&bench.splice(bench.indexOf(this),1),bullpen.indexOf(this)>-1&&bullpen.splice(bullpen.indexOf(this),1),game.log.noteSubstitution(this,player)},resetStats:function(){var IP,ER,GS,W,L,gamesIntoSeason=arguments.length<=0||void 0===arguments[0]?0:arguments[0],offense=this.skill.offense,defense=this.skill.defense,randBetween=function(a,b,skill){var total=0,count=0;return skill+="",skill||(skill=""),_baseballServices_services.Iterator.each(skill.split(" "),function(key,value){var skill=value;offense[skill]&&(skill=offense[skill]),defense[skill]&&(skill=defense[skill]),isNaN(skill)&&(skill=50),total+=skill,count++}),skill=Math.sqrt(.05+.95*Math.random())*(total/(.97*count)),Math.floor(skill/100*(b-a)+a)};this.skill.pitching>65&&(IP=(this.skill.pitching-65)*gamesIntoSeason/20,ER=IP/9*randBetween(800,215,this.skill.pitching)/100,IP>gamesIntoSeason?(GS=Math.floor(gamesIntoSeason/5),W=randBetween(.1*GS,.8*GS,this.skill.pitching/1.2),L=randBetween(GS-W,0,this.skill.pitching/3)):(GS=Math.floor(gamesIntoSeason/40),W=randBetween(0,.6*GS,this.skill.pitching),L=randBetween(GS-W,0,this.skill.pitching)));var pa=randBetween(3*gamesIntoSeason,5*gamesIntoSeason,"speed eye"),paRemaining=pa,bb=Math.floor(randBetween(0,18,"power eye")*paRemaining/100);paRemaining-=bb;var ab=paRemaining,so=Math.floor(randBetween(25,2,"eye")*paRemaining/100);paRemaining-=so;var h=Math.floor(randBetween(185,372,"eye power speed")*paRemaining/1e3);paRemaining-=h;var sb=0|randBetween(0,(h+bb)/6,"speed"),cs=0|randBetween(sb,0,"speed eye"),doubles=randBetween(0,h/4,"power speed"),triples=randBetween(0,h/12,"speed"),hr=Math.max(0,randBetween(-h/20,h/5,"power eye")),r=randBetween(h/8,(h+bb)/3,"speed")+hr,rbi=randBetween(h/8,h/2,"power eye")+hr,hbp=randBetween(0,gamesIntoSeason/25),sac=randBetween(0,gamesIntoSeason/5,"eye"),chances=randBetween(5*gamesIntoSeason,pa-bb-so-hr,"fielding"),E=randBetween(chances/10,0,"fielding"),PO=chances-E;this.stats={pitching:{pitches:0,GS:GS,W:W,L:L,strikes:0,K:0,getK9:function(){return this.K/(this.IP[0]/9)},getERA:function(){return 9*this.ER/Math.max(1/3,this.IP[0]+this.IP[1]/3)},ERA:null,ER:ER,H:0,HR:0,BB:0,IP:[IP,0],WHIP:0,getWHIP:function(){return(this.H+this.BB)/(this.IP[0]?this.IP[0]:1)}},batting:{getBA:function(){return this.h/Math.max(1,this.ab)},getBABIP:function(){return(this.h-this.hr)/(this.ab-this.so-this.hr+this.sac)},ba:null,getOBP:function(){return(this.h+this.bb+this.hbp)/(this.ab+this.bb+this.hbp+this.sac)},obp:null,getSLG:function(){return(this.h-this["2b"]-this["3b"]-this.hr+2*this["2b"]+3*this["3b"]+4*this.hr)/this.ab},getSlash:function(){return this.slash=this.slash||[this.getBA(),this.getOBP(),this.getSLG()].map(function(x){return 1>x?(x+"0000").slice(1,5):(x+"0000").slice(0,5)}).join("/"),this.slash},slg:null,pa:pa,ab:ab,so:so,bb:bb,h:h,"2b":doubles,"3b":triples,hr:hr,r:r,rbi:rbi,hbp:hbp,sac:sac,sb:sb,cs:cs},fielding:{E:E,PO:PO,A:Math.floor(5*Math.random())+1}},this.stats.pitching.ERA=this.stats.pitching.getERA(),this.stats.pitching.K9=this.stats.pitching.getK9(),this.stats.pitching.WHIP=this.stats.pitching.getWHIP(),this.stats.batting.ba=this.stats.batting.getBA()},atBatObjects:[],getAtBats:function(){return this.atBats.length>this.atBatObjects.length&&(this.atBatObjects=this.atBats.map(function(item){return new _baseballModel_models.AtBat(item)})),this.atBatObjects},recordRBI:function(){this.atBats[this.atBats.length-1]+=_baseballModel_models.AtBat.prototype.RBI_INDICATOR},recordInfieldHit:function(){this.atBats[this.atBats.length-1]+=_baseballModel_models.AtBat.prototype.INFIELD_HIT_INDICATOR},getBaseRunningTime:function(){return _baseballServices_services.Mathinator.baseRunningTime(this.skill.offense.speed)},attemptSteal:function(game,base){var pitch=game.pitchInFlight,success=_baseballServices_services.Distribution.stealSuccess(pitch,game.pitcher.team.positions.catcher,this,base,this.team.stealAttempt===_baseballModel_models.Team.RUNNERS_DISCRETION);switch(success?(game.swingResult.stoleABase=this,game.swingResult.caughtStealing=null):(game.swingResult.stoleABase=null,game.swingResult.caughtStealing=this),base){case 1:base="1st";break;case 2:base="2nd";break;case 3:base="3rd";break;case 4:base="Home"}return game.swingResult.attemptedBase=base,this},randomizeSkills:function(hero,allPitches){this.hero=hero;var giraffe=this,randValue=function(isPitching){var value=Math.floor(80*Math.pow(Math.random(),.75)+20*Math.random());return hero&&(value+=Math.floor((100-value)*Math.max(Math.random(),isPitching?0:.65))),isPitching&&giraffe.pitching.averaging.push(value),value};this.skill.offense={eye:randValue(),power:randValue(),speed:randValue()},this.skill.defense={catching:randValue(),fielding:randValue(),speed:randValue(),throwing:randValue()},this.pitching.averaging=[],this.pitching["4-seam"]={velocity:randValue(!0),"break":randValue(!0),control:randValue(!0)},this.pitching.slider={velocity:randValue(!0),"break":randValue(!0),control:randValue(!0)},(Math.random()<.17||allPitches)&&((Math.random()>.6||allPitches)&&(this.pitching["2-seam"]={velocity:randValue(!0),"break":randValue(!0),control:randValue(!0)}),(Math.random()<.18||allPitches)&&(this.pitching.fork={velocity:randValue(!0),"break":randValue(!0),control:randValue(!0)}),(Math.random()>.77||allPitches)&&(this.pitching.cutter={velocity:randValue(!0),"break":randValue(!0),control:randValue(!0)}),(Math.random()<.21||allPitches)&&(this.pitching.sinker={velocity:randValue(!0),"break":randValue(!0),control:randValue(!0)}),(Math.random()<.4||allPitches)&&(this.pitching.curve={velocity:randValue(!0),"break":randValue(!0),control:randValue(!0)}),(Math.random()<.9||allPitches)&&(this.pitching.change={velocity:randValue(!0),"break":randValue(!0),control:randValue(!0)})),this.skill.pitching=Math.floor(this.pitching.averaging.reduce(function(prev,current){return prev+current})/this.pitching.averaging.length+3*this.pitching.averaging.length),delete this.pitching.averaging},getSurname:function(){return"n"==_baseballUtility_utils.text.mode?this.surnameJ:this.surname},getName:function(){return"n"==_baseballUtility_utils.text.mode?this.nameJ:this.name},getUniformNumber:function(){return _baseballUtility_utils.text("#")+this.number},getOrder:function(){return _baseballUtility_utils.text([" 1st"," 2nd"," 3rd"," 4th"," 5th"," 6th","7th"," 8th"," 9th"][this.order])},toString:function(){return this.name+" #"+this.number},eye:{},fatigue:0,name:"",number:0,position:"",atBats:[]},exports.Player=Player},{"baseball/Model/_models":8,"baseball/Services/_services":28,"baseball/Utility/_utils":33}],6:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _baseballModelPlayer=require("baseball/Model/Player"),_baseballModelManager=require("baseball/Model/Manager"),_baseballUtility_utils=require("baseball/Utility/_utils"),Team=function(game){this.init(game)};Team.RUNNERS_DISCRETION="runnersDiscretion",Team.RUNNER_GO="go",Team.RUNNER_HOLD="hold",Team.prototype={constructor:Team,init:function(game){if(this.substituted=[],this.pickName(),this.lineup=[],this.bench=[],this.bullpen=[],this.positions={pitcher:null,catcher:null,first:null,second:null,"short":null,third:null,left:null,center:null,right:null},this.manager=new _baseballModelManager.Manager(this),"no init"!==game){this.game=game;for(var j=0;20>j;j++)this.bench.push(new _baseballModelPlayer.Player(this));20==this.bench.length&&this.manager.makeLineup()}},pickName:function(){var teamNameIndex=Math.floor(Math.random()*_baseballUtility_utils.data.teamNames.length);this.name=_baseballUtility_utils.data.teamNames[teamNameIndex],this.nameJ=_baseballUtility_utils.data.teamNamesJ[teamNameIndex]},getName:function(){return"n"==_baseballUtility_utils.text.mode?this.nameJ:this.name},stealAttempt:Team.RUNNERS_DISCRETION,lineup:[],positions:{},manager:null,bench:[],bullpen:[],nowBatting:0,expanded:"Player&"},exports.Team=Team},{"baseball/Model/Manager":4,"baseball/Model/Player":5,"baseball/Utility/_utils":33}],7:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _baseballUtility_utils=require("baseball/Utility/_utils"),Umpire=(require("baseball/Model/Player"),function(game){this.init(game)});Umpire.prototype={constructor:Umpire,init:function(game){this.game=game,this.playBall()},count:{strikes:0,balls:0,outs:0},playBall:function(){var game=this.game;game.half="top",game.inning=1,game.batter=game.teams.away.lineup[0],game.batterRunner=game.teams.away.lineup[0],game.deck=game.teams.away.lineup[1],game.hole=game.teams.away.lineup[2],game.pitcher=game.teams.home.positions.pitcher;var n="一回のオモテ、"+game.teams.away.getName()+"の攻撃対"+game.teams.home.getName()+"、ピッチャーは"+game.teams.home.positions.pitcher.getName()+"。",e="Top 1, "+game.teams.away.name+" offense vs. "+game.teams.home.positions.pitcher.name+" starting for "+game.teams.home.name;game.log.note(e,n),game.log.noteBatter(game.batter)},makeCall:function(){this.says="";var game=this.game,result=game.swingResult,pitcher=game.pitcher,batter=game.batter,field=game.field;if(game.swingResult.fielder)var fielder=game.teams["top"==game.half?"home":"away"].positions[result.fielder];else fielder=null;if(game.batterRunner=game.batter,result.stoleABase){var thief=result.stoleABase;switch(thief.atBats.push(_baseballUtility_utils.Log.prototype.STOLEN_BASE),thief){case field.first:field.second=thief,field.first=null;break;case field.second:field.third=thief,field.second=null;break;case field.third:field.third=null,thief.stats.batting.r++,thief.atBats.push(_baseballUtility_utils.Log.prototype.RUN),this.runScores()}thief.stats.batting.sb++}if(result.caughtStealing){switch(game.teams["top"==game.half?"home":"away"].positions.catcher.stats.fielding.PO++,this.count.outs++,thief=result.caughtStealing,thief.stats.batting.cs++,thief.atBats.push(_baseballUtility_utils.Log.prototype.CAUGHT_STEALING),thief){case field.first:field.first=null;break;case field.second:field.second=null;break;case field.third:field.third=null}if(this.count.outs>=3)return this.says="Three outs, change.",this.count.outs=this.count.balls=this.count.strikes=0,pitcher.stats.pitching.IP[0]++,pitcher.stats.pitching.IP[1]=0,this.changeSides()}if(pitcher.stats.pitching.pitches++,result.looking)result.strike?(this.count.strikes++,pitcher.stats.pitching.strikes++):this.count.balls++;else if(pitcher.stats.pitching.strikes++,result.contact){if(game.passMinutes(1),result.caught)batter.stats.batting.pa++,pitcher.stats.pitching.IP[1]++,result.sacrificeAdvances.length&&this.count.outs<2?(batter.stats.batting.sac++,game.batter.atBats.push(_baseballUtility_utils.Log.prototype.SACRIFICE),this.advanceRunners(!1,null,result.sacrificeAdvances)):(batter.stats.batting.ab++,result.flyAngle<15?game.batter.atBats.push(_baseballUtility_utils.Log.prototype.LINEOUT):game.batter.atBats.push(_baseballUtility_utils.Log.prototype.FLYOUT)),this.count.outs++,fielder.stats.fielding.PO++,this.newBatter();else if(result.foul)this.count.strikes++,this.count.strikes>2&&(this.count.strikes=2);else if(batter.stats.batting.pa++,batter.stats.batting.ab++,result.firstOut&&(game.field[result.firstOut]=null,result.additionalOuts.map(function(runner){"batter"!==runner&&(game.field[runner]=null)}),this.count.outs+=result.additionalOuts.length),result.fieldersChoice&&this.count.outs<2?(result.bases=0,this.count.outs++,fielder.stats.fielding.PO++,pitcher.stats.pitching.IP[1]++,game.batter.atBats.push(_baseballUtility_utils.Log.prototype.FIELDERS_CHOICE),this.advanceRunners(!1,result.fieldersChoice),result.doublePlay&&game.batter.atBats.push(_baseballUtility_utils.Log.prototype.GIDP),this.reachBase(),result.outs=this.count.outs,this.newBatter()):result.fieldersChoice&&(result.bases=0,result.thrownOut=!0),result.thrownOut&&(this.count.outs++,fielder.stats.fielding.PO++,pitcher.stats.pitching.IP[1]++,game.batter.atBats.push(_baseballUtility_utils.Log.prototype.GROUNDOUT),result.doublePlay&&game.batter.atBats.push(_baseballUtility_utils.Log.prototype.GIDP),this.count.outs<3&&this.advanceRunners(!1),result.outs=this.count.outs,this.newBatter()),result.hitByPitch&&batter.stats.batting.ab--,result.bases){result.error?result.bases>0&&(game.tally["top"==game.half?"home":"away"].E++,fielder.stats.fielding.E++):(game.tally["top"==game.half?"away":"home"][_baseballUtility_utils.Log.prototype.SINGLE]++,pitcher.stats.pitching.H++);var bases=result.bases;switch(bases){case 0:game.batter.atBats.push(_baseballUtility_utils.Log.prototype.GROUNDOUT);break;case 1:result.error?game.batter.atBats.push(_baseballUtility_utils.Log.prototype.REACHED_ON_ERROR):(game.batter.atBats.push(_baseballUtility_utils.Log.prototype.SINGLE),batter.stats.batting.h++);break;case 2:game.batter.atBats.push(_baseballUtility_utils.Log.prototype.DOUBLE),batter.stats.batting.h++,batter.stats.batting["2b"]++;break;case 3:game.batter.atBats.push(_baseballUtility_utils.Log.prototype.TRIPLE),batter.stats.batting.h++,batter.stats.batting["3b"]++;break;case 4:game.batter.atBats.push(_baseballUtility_utils.Log.prototype.HOMERUN),pitcher.stats.pitching.HR++,batter.stats.batting.h++,batter.stats.batting.hr++}for(bases>0&&4>bases&&!result.error&&-1==["left","right","center"].indexOf(result.fielder)&&batter.recordInfieldHit(),bases>=1&&(this.advanceRunners(),this.reachBase(),bases-=1);bases>0;)bases-=1,this.advanceRunners();this.newBatter()}}else this.count.strikes++;this.says=this.count.balls+" and "+this.count.strikes,result.outs=this.count.outs,this.count.strikes>2&&(batter.stats.batting.pa++,batter.stats.batting.ab++,batter.stats.batting.so++,pitcher.stats.pitching.K++,this.count.outs++,pitcher.stats.pitching.IP[1]++,this.count.balls=this.count.strikes=0,this.says="Strike three. Batter out.",batter.atBats.push(_baseballUtility_utils.Log.prototype.STRIKEOUT),this.newBatter()),this.count.balls>3&&(batter.stats.batting.pa++,batter.stats.batting.bb++,pitcher.stats.pitching.BB++,this.says="Ball four.",this.count.balls=this.count.strikes=0,batter.atBats.push(_baseballUtility_utils.Log.prototype.WALK),this.advanceRunners(!0).reachBase().newBatter()),this.count.outs>2&&(this.says="Three outs, change.",this.count.outs=this.count.balls=this.count.strikes=0,pitcher.stats.pitching.IP[0]++,pitcher.stats.pitching.IP[1]=0,this.changeSides())},reachBase:function(){var game=this.game;return game.field.first=game.batter,game.field.first.fatigue+=2,this},advanceRunners:function(isWalk,fieldersChoice,sacrificeAdvances){isWalk=!!isWalk;var game=this.game,first=game.field.first,second=game.field.second,third=game.field.third,swing=game.swingResult;if(isWalk)first&&(second?third?(game.batter.recordRBI(),game.batter.stats.batting.rbi++,third.atBats.push(_baseballUtility_utils.Log.prototype.RUN),third.stats.batting.r++,game.pitcher.stats.pitching.ER++,this.runScores(),game.field.third=second,game.field.second=first,first=null):(game.field.third=second,game.field.second=first,game.field.first=null):third?(game.field.second=first,game.field.first=null):(game.field.second=first,game.field.first=null));else{fieldersChoice&&(game.field[fieldersChoice]=null,first=game.field.first,second=game.field.second,third=game.field.third);var canAdvance=function(){return!0};sacrificeAdvances&&(canAdvance=function(position){switch(position){case"first":return sacrificeAdvances.indexOf("first")>-1&&!game.field.second;case"second":return sacrificeAdvances.indexOf("second")>-1&&!game.field.third;case"third":return sacrificeAdvances.indexOf("third")>-1}});var arm=0;if(swing.fielder){var fielder=game.pitcher.team.positions[swing.fielder];arm=["left","center","right"].indexOf(fielder.position)>-1?fielder.skill.defense.throwing:fielder.skill.defense.throwing+120}third&&canAdvance("third")&&(this.runScores(),game.batter!=third&&(game.batter.recordRBI(),third.atBats.push(_baseballUtility_utils.Log.prototype.RUN)),game.batter.stats.batting.rbi++,third.stats.batting.r++,game.pitcher.stats.pitching.ER++,game.field.third=null),second&&canAdvance("second")&&(game.field.third=second,game.field.second=null,second!=game.batter&&!sacrificeAdvances&&Math.random()*(second.skill.offense.speed+120)>arm+50&&(this.runScores(),game.batter!=second&&(game.batter.recordRBI(),second.atBats.push(_baseballUtility_utils.Log.prototype.RUN)),game.field.third=null)),first&&canAdvance("first")&&(game.field.second=first,game.field.first=null,first!=game.batter&&!game.field.third&&!sacrificeAdvances&&Math.random()*(first.skill.offense.speed+120)>arm+60&&(game.field.third=first,game.field.second=null))}return this},runScores:function(){var game=this.game;game.scoreboard["top"==game.half?"away":"home"][game.inning]++,game.tally["top"==game.half?"away":"home"].R++},newBatter:function(){var game=this.game;game.passMinutes(2),game.log.pitchRecord={e:[],n:[]},this.count.balls=this.count.strikes=0,game.log.notePlateAppearanceResult(game);var team="bottom"==game.half?game.teams.home:game.teams.away;game.lastBatter=game.batter,game.batter=team.lineup[(team.nowBatting+1)%9],game.deck=team.lineup[(team.nowBatting+2)%9],game.hole=team.lineup[(team.nowBatting+3)%9],team.nowBatting=(team.nowBatting+1)%9,this.count.outs<3&&game.log.noteBatter(game.batter),game.showPlayResultPanels(game.lastBatter)},changeSides:function(){var game=this.game;game.passMinutes(5),game.swingResult={},game.swingResult.looking=!0,game.pitchInFlight.x=null,game.pitchInFlight.y=null,game.log.pitchRecord={e:[],n:[]};var offense,defense;if(game.field.first=null,game.field.second=null,game.field.third=null,"top"==game.half){if(9==game.inning&&game.tally.home.R>game.tally.away.R)return game.end();game.half="bottom"}else{if(game.inning+1>9)return game.end();game.inning++,game.half="top"}offense="top"==game.half?"away":"home",defense="top"==game.half?"home":"away";var n=game.inning+"回の"+("top"==game.half?"オモテ":"ウラ")+"、"+game.teams["top"==game.half?"away":"home"].getName()+"の攻撃。",e=("top"==game.half?"Top":"Bottom")+" "+game.inning;game.log.note(e,n);var team=game.teams[offense];game.batter=team.lineup[team.nowBatting],game.batterRunner=game.batter,game.deck=team.lineup[(team.nowBatting+1)%9],game.hole=team.lineup[(team.nowBatting+2)%9],game.pitcher=game.teams[defense].positions.pitcher,game.log.noteBatter(game.batter),game.autoPitchSelect(),game.field.defense=team.positions},says:"Play ball!",game:null},exports.Umpire=Umpire},{"baseball/Model/Player":5,"baseball/Utility/_utils":33}],8:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _baseballModelAtBat=require("baseball/Model/AtBat"),_baseballModelField=require("baseball/Model/Field"),_baseballModelGame=require("baseball/Model/Game"),_baseballModelManager=require("baseball/Model/Manager"),_baseballModelPlayer=require("baseball/Model/Player"),_baseballModelTeam=require("baseball/Model/Team"),_baseballModelUmpire=require("baseball/Model/Umpire");exports.AtBat=_baseballModelAtBat.AtBat,exports.Field=_baseballModelField.Field,exports.Game=_baseballModelGame.Game,exports.Manager=_baseballModelManager.Manager,exports.Player=_baseballModelPlayer.Player,exports.Team=_baseballModelTeam.Team,exports.Umpire=_baseballModelUmpire.Umpire},{"baseball/Model/AtBat":1,"baseball/Model/Field":2,"baseball/Model/Game":3,"baseball/Model/Manager":4,"baseball/Model/Player":5,"baseball/Model/Team":6,"baseball/Model/Umpire":7}],9:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_meshBall=require("./mesh/Ball"),_meshMound=require("./mesh/Mound"),_meshBase=require("./mesh/Base"),_meshField=require("./mesh/Field"),_meshGrass=require("./mesh/Grass"),_meshHomeDirt=require("./mesh/HomeDirt"),_meshBattersEye=require("./mesh/BattersEye"),_meshWall=require("./mesh/Wall"),_meshSky=require("./mesh/Sky"),_meshSun=require("./mesh/Sun"),_sceneLighting=require("./scene/lighting"),_ShadersSkyShader=require("./Shaders/SkyShader"),_baseballServicesAnimator=require("baseball/Services/Animator"),VERTICAL_CORRECTION=-.2,INITIAL_CAMERA_DISTANCE=8;if("undefined"!=typeof THREE)var AHEAD=new THREE.Vector3(0,VERTICAL_CORRECTION,-60.5),INITIAL_POSITION=new THREE.Vector3(0,VERTICAL_CORRECTION,INITIAL_CAMERA_DISTANCE);var Loop=function(){function Loop(elementClass){_classCallCheck(this,Loop),_ShadersSkyShader.loadSkyShader(),this.elementClass=elementClass,this.main(),window.loop=this,this.timeOfDay={h:0,m:0}}return _createClass(Loop,[{key:"loop",value:function(){requestAnimationFrame(this.loop.bind(this)),this.panToward(this.target);var omt=this.overwatchMoveTarget;this.moveToward(this.moveTarget||{x:omt.x,y:omt.y+12,z:omt.z}),this.objects.map(function(i){return i.animate()}),this.renderer.render(this.scene,this.camera)}},{key:"main",value:function(){if(this.objects=[],this.getThree()){var THREE=this.THREE,scene=this.scene=new THREE.Scene;scene.fog=new THREE.FogExp2(6442566,.002),this.attach(),this.lighting=_sceneLighting.lighting,_sceneLighting.lighting.addTo(scene);var camera=this.camera=new THREE.PerspectiveCamera(60,this.getAspect(),.1,1e6);this.target=new THREE.Vector3(0,0,-60.5),this._target=new THREE.Vector3(0,0,-60.5),this.moveTarget=camera.position,this.resetCamera(),this.loop()}}},{key:"addMinutes",value:function(addition){var hours=this.timeOfDay.h,minutes=this.timeOfDay.m;for(minutes+=addition;minutes>=60;)minutes-=60,hours+=1,hours%=24;this.setTimeOfDay(hours,minutes)}},{key:"setTargetTimeOfDay",value:function(hours,minutes){if(this.background)var sun=this.background.sun;else sun=this.sun;sun.setTargetTime(hours,minutes)}},{key:"setTimeOfDay",value:function(hours,minutes){if(this.timeOfDay={h:hours,m:minutes},this.background)var sky=this.background.sky,sun=this.background.sun;else sky=this.sky,sun=this.sun;7.5>hours&&(hours+=24);var azimuth=(hours-7.5)/24+minutes/60/24;sky.uniforms.azimuth=azimuth,azimuth>.5?sky.uniforms.inclination=.48:sky.uniforms.inclination=.39,sun.time.h=hours,sun.time.m=minutes,sun.derivePosition(sky);var luminosity=2*(-.5+Math.max(Math.abs(1.25-azimuth),Math.abs(.25-azimuth)));_baseballServicesAnimator.Animator.setLuminosity(.1+luminosity/1.4)}},{key:"addStaticMeshes",value:function(){(new _meshField.Field).join(this),(new _meshMound.Mound).join(this),(new _meshHomeDirt.HomeDirt).join(this),(new _meshGrass.Grass).join(this),new _meshGrass.Grass(this,!0),(new _meshBattersEye.BattersEye).join(this);var sun=new _meshSun.Sun,sky=new _meshSky.Sky;sun.derivePosition(sky),sky.join(this),sun.join(this),this.sky=sky,this.sun=sun,new _meshWall.Wall(this,-30),new _meshWall.Wall(this,-15),new _meshWall.Wall(this,15),new _meshWall.Wall(this,30),new _meshBase.Base(this,"first"),new _meshBase.Base(this,"second"),new _meshBase.Base(this,"third"),new _meshBase.Base(this,"home")}},{key:"breathe",value:function(){var pos=this.camera.position,y=(pos.x,pos.y),rate=(pos.z,5e-4*this.bob||1);y>.6?this.bob=-1:-.6>y&&(this.bob=1),pos.y+=rate,pos.z+=rate}},{key:"getThree",value:function(){return this.THREE===Loop.prototype.THREE&&"object"==typeof window&&window.THREE?this.THREE=window.THREE:!1}},{key:"attach",value:function(){window.removeEventListener("resize",this.onResize.bind(this),!1),window.addEventListener("resize",this.onResize.bind(this),!1);var element=document.getElementsByClassName(this.elementClass)[0];element.innerHTML="";var THREE=this.THREE,renderer=new THREE.WebGLRenderer({alpha:!0});return this.setSize(renderer),element.appendChild(renderer.domElement),this.renderer=renderer,renderer}},{key:"onResize",value:function(){var element=document.getElementsByClassName(this.elementClass)[0];this.camera.aspect=this.getAspect(),this.camera.fov=Math.max(90-30*(element.offsetWidth/1200),55),this.camera.updateProjectionMatrix(),this.setSize(this.renderer)}},{key:"setSize",value:function(renderer){var element=document.getElementsByClassName(this.elementClass)[0],width=element.offsetWidth;renderer.setSize(width,HEIGHT)}},{key:"getAspect",value:function(){var element=document.getElementsByClassName(this.elementClass)[0];return element.offsetWidth/HEIGHT}},{key:"panToward",value:function(vector){var maxIncrement=this.panSpeed;this.forAllLoops(function(loop){var target=loop._target;target.x=target.x+Math.max(Math.min((vector.x-target.x)/100,maxIncrement),-maxIncrement),target.y=target.y+Math.max(Math.min((vector.y-target.y)/100,maxIncrement),-maxIncrement),target.z=target.z+Math.max(Math.min((vector.z-target.z)/100,maxIncrement),-maxIncrement),loop.camera.lookAt(target)})}},{key:"moveToward",value:function(vector){var maxIncrement=this.moveSpeed;this.forAllLoops(function(loop){var position=loop.camera.position;position.x+=Math.max(Math.min(vector.x-position.x,maxIncrement),-maxIncrement),position.y+=Math.max(Math.min(vector.y-position.y,maxIncrement),-maxIncrement),position.z+=Math.max(Math.min(vector.z-position.z,maxIncrement),-maxIncrement)})}},{key:"setLookTarget",value:function(vector,panSpeed){this.forAllLoops(function(loop){loop.panSpeed=panSpeed||.9,loop.panning=vector!==AHEAD,loop.target=vector})}},{key:"setMoveTarget",value:function(vector,moveSpeed){this.forAllLoops(function(loop){loop.moveSpeed=moveSpeed||.7,loop.moveTarget=vector,loop.overwatchMoveTarget=null})}},{key:"setOverwatchMoveTarget",value:function(vector,moveSpeed){this.forAllLoops(function(loop){loop.moveSpeed=moveSpeed||.7,loop.overwatchMoveTarget=vector,loop.moveTarget=null})}},{key:"resetCamera",value:function(){var moveSpeed=.5;this.camera.position.z!==INITIAL_POSITION.z&&(moveSpeed=2.5),this.setLookTarget(AHEAD,moveSpeed),this.setMoveTarget(INITIAL_POSITION,moveSpeed/10)}},{key:"moveCamera",value:function(x,y,z){return"object"==typeof x?this.moveCamera(x.x,x.y,x.z):void this.forAllLoops(function(loop){loop.camera.position.x=x,loop.camera.position.y=y,loop.camera.position.z=z})}},{key:"forAllLoops",value:function(fn){this.background&&fn(this.background),this.foreground&&fn(this.foreground),fn(this)}},{key:"test",value:function(){var ball=new _meshBall.Ball;window.Ball=_meshBall.Ball,window.ball=ball,ball.setType("4-seam"),ball.animate=function(){ball.rotate()},ball.join(this)}},{key:"testTrajectory",value:function(data){var ball=new _meshBall.Ball;window.Ball=_meshBall.Ball,window.ball=ball,ball.deriveTrajectory(data||{splay:-35,travelDistance:135,flyAngle:-15,x:100,y:100},{x:0,y:0}),ball.join(this)}}]),Loop}(),HEIGHT=700;Loop.VERTICAL_CORRECTION=VERTICAL_CORRECTION,Loop.INITIAL_CAMERA_DISTANCE=INITIAL_CAMERA_DISTANCE,Loop.prototype.THREE={},Loop.prototype.constructors={Ball:_meshBall.Ball,Mound:_meshMound.Mound,Field:_meshField.Field},exports.Loop=Loop},{"./Shaders/SkyShader":10,"./mesh/Ball":12,"./mesh/Base":13,"./mesh/BattersEye":14,"./mesh/Field":15,"./mesh/Grass":16,"./mesh/HomeDirt":17,"./mesh/Mound":19,"./mesh/Sky":20,"./mesh/Sun":21,"./mesh/Wall":22,"./scene/lighting":23,"baseball/Services/Animator":24}],10:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var loadSkyShader=function(){THREE.ShaderLib.sky={uniforms:{luminance:{type:"f",value:1},turbidity:{type:"f",value:2},reileigh:{type:"f",value:1},mieCoefficient:{type:"f",value:.005},mieDirectionalG:{type:"f",value:.8},sunPosition:{type:"v3",value:new THREE.Vector3}},vertexShader:["varying vec3 vWorldPosition;","void main() {","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vWorldPosition = worldPosition.xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D skySampler;","uniform vec3 sunPosition;","varying vec3 vWorldPosition;","vec3 cameraPos = vec3(0., 0., 0.);","// uniform sampler2D sDiffuse;","// const float turbidity = 10.0; //","// const float reileigh = 2.; //","// const float luminance = 1.0; //","// const float mieCoefficient = 0.005;","// const float mieDirectionalG = 0.8;","uniform float luminance;","uniform float turbidity;","uniform float reileigh;","uniform float mieCoefficient;","uniform float mieDirectionalG;","// constants for atmospheric scattering","const float e = 2.71828182845904523536028747135266249775724709369995957;","const float pi = 3.141592653589793238462643383279502884197169;","const float n = 1.0003; // refractive index of air","const float N = 2.545E25; // number of molecules per unit volume for air at","// 288.15K and 1013mb (sea level -45 celsius)","const float pn = 0.035;	// depolatization factor for standard air","// wavelength of used primaries, according to preetham","const vec3 lambda = vec3(680E-9, 550E-9, 450E-9);","// mie stuff","// K coefficient for the primaries","const vec3 K = vec3(0.686, 0.678, 0.666);","const float v = 4.0;","// optical length at zenith for molecules","const float rayleighZenithLength = 8.4E3;","const float mieZenithLength = 1.25E3;","const vec3 up = vec3(0.0, 1.0, 0.0);","const float EE = 1000.0;","const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;","// 66 arc seconds -> degrees, and the cosine of that","// earth shadow hack","const float cutoffAngle = pi/1.95;","const float steepness = 1.5;","vec3 totalRayleigh(vec3 lambda)","{","return (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn));","}","// A simplied version of the total Reayleigh scattering to works on browsers that use ANGLE","vec3 simplifiedRayleigh()","{","return 0.0005 / vec3(94, 40, 18);","}","float rayleighPhase(float cosTheta)","{	 ","return (3.0 / (16.0*pi)) * (1.0 + pow(cosTheta, 2.0));","//	return (1.0 / (3.0*pi)) * (1.0 + pow(cosTheta, 2.0));","//	return (3.0 / 4.0) * (1.0 + pow(cosTheta, 2.0));","}","vec3 totalMie(vec3 lambda, vec3 K, float T)","{","float c = (0.2 * T ) * 10E-18;","return 0.434 * c * pi * pow((2.0 * pi) / lambda, vec3(v - 2.0)) * K;","}","float hgPhase(float cosTheta, float g)","{","return (1.0 / (4.0*pi)) * ((1.0 - pow(g, 2.0)) / pow(1.0 - 2.0*g*cosTheta + pow(g, 2.0), 1.5));","}","float sunIntensity(float zenithAngleCos)","{","return EE * max(0.0, 1.0 - exp(-((cutoffAngle - acos(zenithAngleCos))/steepness)));","}","// float logLuminance(vec3 c)","// {","// 	return log(c.r * 0.2126 + c.g * 0.7152 + c.b * 0.0722);","// }","// Filmic ToneMapping http://filmicgames.com/archives/75","float A = 0.15;","float B = 0.50;","float C = 0.10;","float D = 0.20;","float E = 0.02;","float F = 0.30;","float W = 1000.0;","vec3 Uncharted2Tonemap(vec3 x)","{","return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;","}","void main() ","{","float sunfade = 1.0-clamp(1.0-exp((sunPosition.y/450000.0)),0.0,1.0);","// luminance =  1.0 ;// vWorldPosition.y / 450000. + 0.5; //sunPosition.y / 450000. * 1. + 0.5;","// gl_FragColor = vec4(sunfade, sunfade, sunfade, 1.0);","float reileighCoefficient = reileigh - (1.0* (1.0-sunfade));","vec3 sunDirection = normalize(sunPosition);","float sunE = sunIntensity(dot(sunDirection, up));","// extinction (absorbtion + out scattering) ","// rayleigh coefficients","vec3 betaR = simplifiedRayleigh() * reileighCoefficient;","// mie coefficients","vec3 betaM = totalMie(lambda, K, turbidity) * mieCoefficient;","// optical length","// cutoff angle at 90 to avoid singularity in next formula.","float zenithAngle = acos(max(0.0, dot(up, normalize(vWorldPosition - cameraPos))));","float sR = rayleighZenithLength / (cos(zenithAngle) + 0.15 * pow(93.885 - ((zenithAngle * 180.0) / pi), -1.253));","float sM = mieZenithLength / (cos(zenithAngle) + 0.15 * pow(93.885 - ((zenithAngle * 180.0) / pi), -1.253));","// combined extinction factor	","vec3 Fex = exp(-(betaR * sR + betaM * sM));","// in scattering","float cosTheta = dot(normalize(vWorldPosition - cameraPos), sunDirection);","float rPhase = rayleighPhase(cosTheta*0.5+0.5);","vec3 betaRTheta = betaR * rPhase;","float mPhase = hgPhase(cosTheta, mieDirectionalG);","vec3 betaMTheta = betaM * mPhase;","vec3 Lin = pow(sunE * ((betaRTheta + betaMTheta) / (betaR + betaM)) * (1.0 - Fex),vec3(1.5));","Lin *= mix(vec3(1.0),pow(sunE * ((betaRTheta + betaMTheta) / (betaR + betaM)) * Fex,vec3(1.0/2.0)),clamp(pow(1.0-dot(up, sunDirection),5.0),0.0,1.0));","//nightsky","vec3 direction = normalize(vWorldPosition - cameraPos);","float theta = acos(direction.y); // elevation --> y-axis, [-pi/2, pi/2]","float phi = atan(direction.z, direction.x); // azimuth --> x-axis [-pi/2, pi/2]","vec2 uv = vec2(phi, theta) / vec2(2.0*pi, pi) + vec2(0.5, 0.0);","// vec3 L0 = texture2D(skySampler, uv).rgb+0.1 * Fex;","vec3 L0 = vec3(0.1) * Fex;","// composition + solar disc","//if (cosTheta > sunAngularDiameterCos)","float sundisk = smoothstep(sunAngularDiameterCos,sunAngularDiameterCos+0.00002,cosTheta);","// if (normalize(vWorldPosition - cameraPos).y>0.0)","L0 += (sunE * 19000.0 * Fex)*sundisk;","vec3 whiteScale = 1.0/Uncharted2Tonemap(vec3(W));","vec3 texColor = (Lin+L0);   ","texColor *= 0.04 ;","texColor += vec3(0.0,0.001,0.0025)*0.3;","float g_fMaxLuminance = 1.0;","float fLumScaled = 0.1 / luminance;     ","float fLumCompressed = (fLumScaled * (1.0 + (fLumScaled / (g_fMaxLuminance * g_fMaxLuminance)))) / (1.0 + fLumScaled); ","float ExposureBias = fLumCompressed;","vec3 curr = Uncharted2Tonemap((log2(2.0/pow(luminance,4.0)))*texColor);","vec3 color = curr*whiteScale;","vec3 retColor = pow(color,vec3(1.0/(1.2+(1.2*sunfade))));","gl_FragColor.rgb = retColor;","gl_FragColor.a = 1.0;","}"].join("\n")
},THREE.Sky=function(){var skyShader=THREE.ShaderLib.sky,skyUniforms=THREE.UniformsUtils.clone(skyShader.uniforms),skyMat=new THREE.ShaderMaterial({fragmentShader:skyShader.fragmentShader,vertexShader:skyShader.vertexShader,uniforms:skyUniforms,side:THREE.BackSide}),skyGeo=new THREE.SphereBufferGeometry(45e4,32,15),skyMesh=new THREE.Mesh(skyGeo,skyMat);this.mesh=skyMesh,this.uniforms=skyUniforms}};exports.loadSkyShader=loadSkyShader},{}],11:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Loop=require("../Loop"),AbstractMesh=function(){function AbstractMesh(){_classCallCheck(this,AbstractMesh)}return _createClass(AbstractMesh,[{key:"attach",value:function(){var objects=this.loop.objects;-1===objects.indexOf(this)&&objects.push(this),this.loop.scene.add(this.mesh)}},{key:"detach",value:function(){var objects=this.loop.objects,index=objects.indexOf(this);-1!==index&&this.loop.objects.splice(index,1),this.loop.scene.remove(this.mesh)}},{key:"join",value:function(loop){this.loop=loop||this.loop,this.loop instanceof _Loop.Loop&&this.attach()}},{key:"animate",value:function(){}}]),AbstractMesh}();AbstractMesh.WORLD_BASE_Y=-4,exports.AbstractMesh=AbstractMesh},{"../Loop":9}],12:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1,null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_AbstractMesh2=require("./AbstractMesh"),_Loop=require("../Loop"),_baseballServicesMathinator=require("baseball/Services/Mathinator"),_Indicator=require("./Indicator"),_baseballUtilityHelper=require("baseball/Utility/helper"),SCALE=.021,INDICATOR_DEPTH=-5,Ball=function(_AbstractMesh){function Ball(loop,trajectory){_classCallCheck(this,Ball),_get(Object.getPrototypeOf(Ball.prototype),"constructor",this).call(this),!(loop instanceof _Loop.Loop)&&loop instanceof Array&&(trajectory=loop),this.hasIndicator=!1,this.trajectory=trajectory?trajectory:[],this.breakingTrajectory=[],this.getMesh(),loop instanceof _Loop.Loop&&this.join(loop),this.setType("4-seam",1),this.bounce=1}return _inherits(Ball,_AbstractMesh),_createClass(Ball,[{key:"getMesh",value:function(){var baseURL="public/",THREE=window.THREE,loader=new THREE.TextureLoader,textureColor=loader.load(baseURL+"images/BaseballColor.jpg"),textureBump=loader.load(baseURL+"images/BaseballBump.jpg"),geometry=new THREE.SphereGeometry(.36,32,16),material=new THREE.MeshPhongMaterial({map:textureColor,bumpMap:textureBump,bumpScale:.01});return this.mesh=new THREE.Mesh(geometry,material),this.mesh}},{key:"animate",value:function(){var frame=this.trajectory.shift(),pos=this.mesh.position;frame&&(pos.x+=frame.x,pos.y+=frame.y*this.bounce,pos.z+=frame.z,pos.y<_AbstractMesh2.AbstractMesh.WORLD_BASE_Y&&(this.bounce*=-1),frame.x+frame.y+frame.z!==0&&this.rotate()),pos.z>INDICATOR_DEPTH&&!this.hasIndicator&&this.spawnIndicator(),frame||(this.detach(),this.loop.resetCamera())}},{key:"setType",value:function(type,handednessScalar){var rpm=_baseballUtilityHelper.helper.pitchDefinitions[type][4],rotationAngle=_baseballUtilityHelper.helper.pitchDefinitions[type][3];this.setRotation(rpm,rotationAngle*(handednessScalar||1))}},{key:"rotate",value:function(){var rotation=this.rotation,meshRotation=this.mesh.rotation;meshRotation.x+=rotation.x,meshRotation.y+=rotation.y}},{key:"setRotation",value:function(rpm,rotationAngle){this.RPM=rpm,this.RPS=this.RPM/60;var rotationalIncrement=this.RP60thOfASecond=this.RPS/60,xComponent=rotationalIncrement*Math.cos(rotationAngle/180*Math.PI),yComponent=rotationalIncrement*Math.sin(rotationAngle/180*Math.PI);this.rotation={x:360*xComponent*Math.PI/180,y:360*yComponent*Math.PI/180}}},{key:"exportPositionTo",value:function(mesh){mesh.position.x=this.mesh.position.x,mesh.position.y=this.mesh.position.y,mesh.position.z=this.mesh.position.z}},{key:"spawnIndicator",value:function(){if(!this.hasIndicator){this.hasIndicator=!0;var indicator=new _Indicator.Indicator;indicator.mesh.position.x=this.mesh.position.x,indicator.mesh.position.y=this.mesh.position.y,indicator.mesh.position.z=this.mesh.position.z,indicator.join(this.loop.background)}}},{key:"derivePitchingTrajectory",value:function(game){this.setType(game.pitchInFlight.name,"right"===game.pitcher["throws"]?1:-1);var top=200-game.pitchTarget.y,left=game.pitchTarget.x,breakTop=200-game.pitchInFlight.y,breakLeft=game.pitchInFlight.x,flightTime=_baseballServicesMathinator.Mathinator.getFlightTime(game.pitchInFlight.velocity,_baseballUtilityHelper.helper.pitchDefinitions[game.pitchInFlight.name][2]),scale=SCALE,origin={x:"left"==game.pitcher["throws"]?1.5:-1.5,y:_AbstractMesh2.AbstractMesh.WORLD_BASE_Y+6,z:-60.5};this.mesh.position.x=origin.x,this.mesh.position.y=origin.y,this.mesh.position.z=origin.z;for(var ARC_APPROXIMATION_Y_ADDITIVE=38,terminus={x:(left-100)*scale,y:(100-top+2*ARC_APPROXIMATION_Y_ADDITIVE)*scale+_Loop.Loop.VERTICAL_CORRECTION,z:INDICATOR_DEPTH},breakingTerminus={x:(breakLeft-100)*scale,y:(100-breakTop)*scale+_Loop.Loop.VERTICAL_CORRECTION,z:INDICATOR_DEPTH},lastPosition={x:origin.x,y:origin.y,z:origin.z},lastBreakingPosition={x:origin.x,y:origin.y,z:origin.z},frames=[],breakingFrames=[],frameCount=60*flightTime|0,counter=1.08*frameCount|0,frame=0,xBreak=breakingTerminus.x-terminus.x,yBreak=breakingTerminus.y-terminus.y,breakingDistance=Math.sqrt(Math.pow(xBreak,2)+Math.pow(yBreak,2)),breakingLateness=breakingDistance/(2*ARC_APPROXIMATION_Y_ADDITIVE)/scale,breakingLatenessMomentumExponent=.2+Math.pow(.45,breakingLateness);counter--;){var progress=++frame/frameCount,position={x:origin.x+(terminus.x-origin.x)*progress,y:origin.y+(terminus.y-origin.y)*progress,z:origin.z+(terminus.z-origin.z)*progress},breakingInfluencePosition={x:origin.x+(breakingTerminus.x-origin.x)*progress,y:origin.y+(breakingTerminus.y-origin.y)*progress,z:origin.z+(breakingTerminus.z-origin.z)*progress};if(progress>1)momentumScalar=1-Math.pow(progress,breakingLateness);else var momentumScalar=Math.pow(1-progress,breakingLatenessMomentumExponent);var breakingScalar=1-momentumScalar,scalarSum=momentumScalar+breakingScalar,breakingPosition={x:(position.x*momentumScalar+breakingInfluencePosition.x*breakingScalar)/scalarSum,y:(position.y*momentumScalar+breakingInfluencePosition.y*breakingScalar)/scalarSum,z:(position.z*momentumScalar+breakingInfluencePosition.z*breakingScalar)/scalarSum},increment={x:position.x-lastPosition.x,y:position.y-lastPosition.y,z:position.z-lastPosition.z},breakingIncrement={x:breakingPosition.x-lastBreakingPosition.x,y:breakingPosition.y-lastBreakingPosition.y,z:breakingPosition.z-lastBreakingPosition.z};lastPosition=position,lastBreakingPosition=breakingPosition,breakingFrames.push(breakingIncrement),frames.push(increment)}for(var pause=60;pause--;)breakingFrames.push({x:0,y:0,z:0}),frames.push({x:0,y:0,z:0});return this.breakingTrajectory=breakingFrames,this.trajectory=frames,frames}},{key:"deriveTrajectory",value:function(result,pitch){var dragScalarApproximation={distance:1,apexHeight:.57,airTime:.96},flyAngle=result.flyAngle,distance=Math.abs(result.travelDistance),flightScalar=(result.travelDistance<0?-1:1,7>flyAngle?-1:1),splay=result.splay;0>flightScalar&&result.travelDistance>0&&(distance=Math.max(90,distance)),flyAngle=1+Math.abs(flyAngle),flyAngle>90&&(flyAngle=180-flyAngle);var velocity=dragScalarApproximation.distance*Math.sqrt(9.81*distance/Math.sin(2*Math.PI*flyAngle/180)),velocityVerticalComponent=Math.sin(_baseballServicesMathinator.Mathinator.RADIAN*flyAngle)*velocity,apexHeight=velocityVerticalComponent*velocityVerticalComponent/19.62*dragScalarApproximation.apexHeight,airTime=1.5*Math.sqrt(2*apexHeight/9.81)*dragScalarApproximation.airTime;this.airTime=airTime;var scale=SCALE,origin={x:pitch.x+result.x-100,y:pitch.y+result.y-100,z:0};this.mesh.position.x=origin.x*scale,this.mesh.position.y=origin.y*scale,this.mesh.position.z=origin.z;for(var extrema={x:Math.sin(splay/180*Math.PI)*distance,y:apexHeight,z:-Math.cos(splay/180*Math.PI)*distance},frames=[],frameCount=60*airTime|0,counter=frameCount,frame=0,lastHeight=0;counter--;){var progress=++frame/frameCount,percent=100*progress;if(0>flightScalar){var currentDistance=progress*distance;y=(origin.y*scale+apexHeight*Math.abs(Math.sin(3*Math.pow(currentDistance,1.1)/distance*Math.PI/2)))*((100-percent)/100)+_AbstractMesh2.AbstractMesh.WORLD_BASE_Y*progress}else var y=apexHeight-Math.pow(Math.abs(50-percent)/50,2)*apexHeight;frames.push({x:extrema.x/frameCount,y:y-lastHeight,z:extrema.z/frameCount}),lastHeight=y}return this.trajectory=frames,frames}}]),Ball}(_AbstractMesh2.AbstractMesh);Ball.prototype.DEFAULT_RPM=1e3,Ball.prototype.RPM=1e3,Ball.prototype.RPS=1e3/60,Ball.prototype.RP60thOfASecond=1e3/60/60,Ball.prototype.rotation={x:360*Ball.prototype.RP60thOfASecond*Math.PI/180,y:360*Ball.prototype.RP60thOfASecond*Math.PI/180},exports.Ball=Ball},{"../Loop":9,"./AbstractMesh":11,"./Indicator":18,"baseball/Services/Mathinator":27,"baseball/Utility/helper":35}],13:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1,null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_AbstractMesh2=require("./AbstractMesh"),_Loop=require("../Loop"),Base=function(_AbstractMesh){function Base(loop,base){_classCallCheck(this,Base),_get(Object.getPrototypeOf(Base.prototype),"constructor",this).call(this),this.base=base,this.getMesh(),loop instanceof _Loop.Loop&&this.join(loop)}return _inherits(Base,_AbstractMesh),_createClass(Base,[{key:"getMesh",value:function(){var material=new THREE.MeshLambertMaterial({color:16777215}),mesh=new THREE.Mesh(new THREE.BoxGeometry(3,.3,3,8,8,8),material);switch(mesh.rotation.x=-0/180*Math.PI,mesh.rotation.y=0,mesh.rotation.z=0*Math.PI,this.base){case"first":mesh.position.x=64,mesh.position.z=-64;break;case"second":mesh.position.x=0,mesh.position.z=-121;break;case"third":mesh.position.x=-64,mesh.position.z=-64;break;case"home":mesh.position.x=0,mesh.position.z=0,mesh.rotation.z=0}return mesh.position.y=_AbstractMesh2.AbstractMesh.WORLD_BASE_Y+.5,mesh.position.z-=0,this.mesh=mesh,this.mesh}},{key:"animate",value:function(){}}]),Base}(_AbstractMesh2.AbstractMesh);exports.Base=Base},{"../Loop":9,"./AbstractMesh":11}],14:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1,null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_AbstractMesh2=require("./AbstractMesh"),_Loop=require("../Loop"),BattersEye=function(_AbstractMesh){function BattersEye(loop){_classCallCheck(this,BattersEye),_get(Object.getPrototypeOf(BattersEye.prototype),"constructor",this).call(this),this.getMesh(),loop instanceof _Loop.Loop&&this.join(loop)}return _inherits(BattersEye,_AbstractMesh),_createClass(BattersEye,[{key:"getMesh",value:function(){var material=new THREE.MeshLambertMaterial({color:4145221}),mesh=new THREE.Mesh(new THREE.BoxGeometry(200,45,4,16,16,16),material);return mesh.position.y=_AbstractMesh2.AbstractMesh.WORLD_BASE_Y+0,mesh.position.z-=310,this.mesh=mesh,this.mesh}},{key:"animate",value:function(){}}]),BattersEye}(_AbstractMesh2.AbstractMesh);exports.BattersEye=BattersEye},{"../Loop":9,"./AbstractMesh":11}],15:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1,null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_AbstractMesh2=require("./AbstractMesh"),_Loop=require("../Loop"),Field=function(_AbstractMesh){function Field(loop){_classCallCheck(this,Field),_get(Object.getPrototypeOf(Field.prototype),"constructor",this).call(this),this.getMesh(),loop instanceof _Loop.Loop&&this.join(loop)}return _inherits(Field,_AbstractMesh),_createClass(Field,[{key:"getMesh",value:function(){var material=new THREE.MeshLambertMaterial({color:14463126}),mesh=new THREE.Mesh(new THREE.PlaneGeometry(155,155,32,32),material);return mesh.rotation.x=-0.5*Math.PI,mesh.rotation.y=0,mesh.rotation.z=.25*Math.PI,mesh.position.x=0,mesh.position.y=_AbstractMesh2.AbstractMesh.WORLD_BASE_Y,mesh.position.z=-102,this.mesh=mesh,this.mesh}},{key:"animate",value:function(){}}]),Field}(_AbstractMesh2.AbstractMesh);exports.Field=Field},{"../Loop":9,"./AbstractMesh":11}],16:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1,null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_AbstractMesh2=require("./AbstractMesh"),_Loop=require("../Loop"),Grass=function(_AbstractMesh){function Grass(loop,infield){_classCallCheck(this,Grass),_get(Object.getPrototypeOf(Grass.prototype),"constructor",this).call(this),this.infield=infield,this.getMesh(),loop instanceof _Loop.Loop&&this.join(loop)}return _inherits(Grass,_AbstractMesh),_createClass(Grass,[{key:"getMesh",value:function(){var material=new THREE.MeshLambertMaterial({color:this.infield?7377738:4678962}),mesh=new THREE.Mesh(new THREE.PlaneGeometry(this.infield?80:8e3,this.infield?80:8e3,16,16),material);return this.infield?(mesh.rotation.x=-0.5*Math.PI,mesh.rotation.y=0,mesh.rotation.z=.25*Math.PI,mesh.position.x=0,mesh.position.y=_AbstractMesh2.AbstractMesh.WORLD_BASE_Y+.2,mesh.position.z=-62):(mesh.rotation.x=-0.5*Math.PI,mesh.rotation.y=0,mesh.rotation.z=.25*Math.PI,mesh.position.x=0,mesh.position.y=_AbstractMesh2.AbstractMesh.WORLD_BASE_Y-.2,mesh.position.z=-570),this.mesh=mesh,this.mesh}},{key:"animate",value:function(){}}]),Grass}(_AbstractMesh2.AbstractMesh);exports.Grass=Grass},{"../Loop":9,"./AbstractMesh":11}],17:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1,null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_AbstractMesh2=require("./AbstractMesh"),_Loop=require("../Loop"),HomeDirt=function(_AbstractMesh){function HomeDirt(loop){_classCallCheck(this,HomeDirt),_get(Object.getPrototypeOf(HomeDirt.prototype),"constructor",this).call(this),this.getMesh(),loop instanceof _Loop.Loop&&this.join(loop)}return _inherits(HomeDirt,_AbstractMesh),_createClass(HomeDirt,[{key:"getMesh",value:function(){var material=new THREE.MeshLambertMaterial({color:14463126}),mesh=new THREE.Mesh(new THREE.PlaneGeometry(8,8,16,16),material);return mesh.rotation.x=-0.5*Math.PI,mesh.rotation.y=0,mesh.rotation.z=.25*Math.PI,mesh.position.x=0,mesh.position.y=_AbstractMesh2.AbstractMesh.WORLD_BASE_Y,mesh.position.z=0,this.mesh=mesh,this.mesh}},{key:"animate",value:function(){}}]),HomeDirt}(_AbstractMesh2.AbstractMesh);exports.HomeDirt=HomeDirt},{"../Loop":9,"./AbstractMesh":11}],18:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1,null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_AbstractMesh2=require("./AbstractMesh"),_Loop=require("../Loop"),Indicator=function(_AbstractMesh){function Indicator(loop){_classCallCheck(this,Indicator),_get(Object.getPrototypeOf(Indicator.prototype),"constructor",this).call(this);var n=60;for(this.trajectory=[];n--;)this.trajectory.push(1);this.getMesh(),loop instanceof _Loop.Loop&&this.join(loop)}return _inherits(Indicator,_AbstractMesh),_createClass(Indicator,[{key:"getMesh",value:function(){var THREE=window.THREE,geometry=new THREE.CircleGeometry(.3,32),material=new THREE.MeshPhongMaterial({color:16777215});return this.mesh=new THREE.Mesh(geometry,material),this.mesh}},{key:"animate",value:function(){this.trajectory.shift(),this.trajectory.length||this.detach()}}]),Indicator}(_AbstractMesh2.AbstractMesh);exports.Indicator=Indicator},{"../Loop":9,"./AbstractMesh":11}],19:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1,null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_AbstractMesh2=require("./AbstractMesh"),_Loop=require("../Loop"),Mound=function(_AbstractMesh){function Mound(loop){_classCallCheck(this,Mound),_get(Object.getPrototypeOf(Mound.prototype),"constructor",this).call(this),this.getMesh(),loop instanceof _Loop.Loop&&this.join(loop)}return _inherits(Mound,_AbstractMesh),_createClass(Mound,[{key:"getMesh",value:function(){var material=new THREE.MeshLambertMaterial({color:14463126}),mesh=new THREE.Mesh(new THREE.CircleGeometry(9),material);return mesh.rotation.x=-0.5*Math.PI,mesh.rotation.y=0,mesh.rotation.z=.25*Math.PI,mesh.position.x=0,mesh.position.y=_AbstractMesh2.AbstractMesh.WORLD_BASE_Y+.9,mesh.position.z=-60.5,this.mesh=mesh,this.mesh}},{key:"animate",value:function(){}}]),Mound}(_AbstractMesh2.AbstractMesh);exports.Mound=Mound},{"../Loop":9,"./AbstractMesh":11}],20:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1,null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_AbstractMesh2=require("./AbstractMesh"),_Loop=require("../Loop"),Sky=function(_AbstractMesh){function Sky(loop){_classCallCheck(this,Sky),_get(Object.getPrototypeOf(Sky.prototype),"constructor",this).call(this),this.getMesh(),loop instanceof _Loop.Loop&&this.join(loop)}return _inherits(Sky,_AbstractMesh),_createClass(Sky,[{key:"setUniforms",value:function(uniforms){this.uniforms=uniforms;var sky=this.sky;for(var key in uniforms)uniforms.hasOwnProperty(key)&&(sky.uniforms[key]||(sky.uniforms[key]=uniforms[key]),"object"==typeof uniforms[key]&&(sky.uniforms[key].value=uniforms[key].value))}},{key:"getMesh",value:function(){var uniforms=this.uniforms={luminance:{type:"f",value:1},turbidity:{type:"f",value:10},reileigh:{type:"f",value:2},mieCoefficient:{type:"f",value:.005},mieDirectionalG:{type:"f",value:.8},sunPosition:{type:"v3",value:new THREE.Vector3},inclination:.18,azimuth:.75,sun:!1},sky=new THREE.Sky;return this.sky=sky,this.mesh=sky.mesh,this.setUniforms(uniforms),this.mesh}},{key:"animate",value:function(){}}]),Sky}(_AbstractMesh2.AbstractMesh);exports.Sky=Sky},{"../Loop":9,"./AbstractMesh":11}],21:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function");
}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1,null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_AbstractMesh2=require("./AbstractMesh"),_Loop=require("../Loop"),Sun=function(_AbstractMesh){function Sun(loop){_classCallCheck(this,Sun),_get(Object.getPrototypeOf(Sun.prototype),"constructor",this).call(this),this.getMesh(),loop instanceof _Loop.Loop&&this.join(loop),this.targetTime={h:0,m:0},this.time={h:0,m:0}}return _inherits(Sun,_AbstractMesh),_createClass(Sun,[{key:"setTargetTime",value:function(hours,minutes){this.targetTime.h=hours,this.targetTime.m=minutes}},{key:"getMesh",value:function(){var sun=new THREE.Mesh(new THREE.SphereGeometry(2e4,16,8),new THREE.MeshBasicMaterial({color:16777215,wireframe:!0}));return sun.position.z=-95e4,sun.position.y=-1e5,sun.position.x=-2e5,sun.visible=!1,this.mesh=sun,this.mesh}},{key:"derivePosition",value:function(sky){var distance=4e5,uniforms=sky.uniforms,theta=Math.PI*(uniforms.inclination-.5),phi=2*Math.PI*(uniforms.azimuth-.5),mesh=this.mesh;mesh.position.x=distance*Math.cos(phi),mesh.position.y=distance*Math.sin(phi)*Math.sin(theta),mesh.position.z=distance*Math.sin(phi)*Math.cos(theta),mesh.visible=uniforms.sun,sky.uniforms.sunPosition.value.copy(mesh.position)}},{key:"animate",value:function(){(this.time.h!==this.targetTime.h||this.time.m!==this.targetTime.m)&&(this.loop.addMinutes(1),this.time.m+=1,this.time.m>=60&&(this.time.h++,this.time.m-=60,this.time.h%=24))}}]),Sun}(_AbstractMesh2.AbstractMesh);exports.Sun=Sun},{"../Loop":9,"./AbstractMesh":11}],22:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1,null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_AbstractMesh2=require("./AbstractMesh"),_Loop=require("../Loop"),Wall=function(_AbstractMesh){function Wall(loop,angle){_classCallCheck(this,Wall),_get(Object.getPrototypeOf(Wall.prototype),"constructor",this).call(this),this.angle=angle,this.getMesh(),loop instanceof _Loop.Loop&&this.join(loop)}return _inherits(Wall,_AbstractMesh),_createClass(Wall,[{key:"getMesh",value:function(){var material=new THREE.MeshLambertMaterial({color:4145221}),mesh=new THREE.Mesh(new THREE.BoxGeometry(120,15,4,16,16,16),material),radians=this.angle/180*Math.PI;mesh.rotation.y=-radians;var hypotenuse=320,distance=Math.cos(radians)*hypotenuse,offset=Math.sin(radians)*hypotenuse;return mesh.position.x+=offset,mesh.position.y=_AbstractMesh2.AbstractMesh.WORLD_BASE_Y+0,mesh.position.z-=distance,this.mesh=mesh,this.mesh}},{key:"animate",value:function(){}}]),Wall}(_AbstractMesh2.AbstractMesh);exports.Wall=Wall},{"../Loop":9,"./AbstractMesh":11}],23:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var lighting={addTo:function(scene){var light=new THREE.HemisphereLight(16777147,526368,1);scene.add(light);var sun=new THREE.DirectionalLight(16777147,.45);light.position.set(-1,1,1),this.light=light,this.sun=sun,scene.add(sun)},setLuminosity:function(level){this.light.intensity=level,this.sun.intensity=level/2}};exports.lighting=lighting},{}],24:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _baseballServices_services=require("baseball/services/_services"),_baseballRenderLoop=require("baseball/Render/Loop"),_baseballUtilityHelper=require("baseball/Utility/helper"),Animator=function(){throw this.init(),new Error("No need to instantiate Animator")};Animator.TweenMax={},Animator.prototype={identifier:"Animator",constructor:Animator,console:!1,TweenMax:{},THREE:{},renderingMode:"webgl",init:function(){Animator.console||this.loop||"webgl"!==this.renderingMode||this.beginRender()},beginRender:function(){return this.loop=new _baseballRenderLoop.Loop("webgl-container"),this.background=new _baseballRenderLoop.Loop("webgl-bg-container"),this.background.addStaticMeshes(),this.loop.background=this.background,this.background.foreground=this.loop,this.loop},setLuminosity:function(level){this.console||(this.loop.lighting.setLuminosity(level),this.background.lighting.setLuminosity(level))},loadTweenMax:function(){return this.console||"object"!=typeof window?Animator.TweenMax={set:function(){},to:function(){},from:function(){},killAll:function(){}}:Animator.TweenMax=window.TweenMax,Animator.TweenMax},TIME_FROM_SET:2300,TIME_FROM_WINDUP:3600,HOLD_UP_ALLOWANCE:.25,pitchTarget:null,pitchBreak:null,updateFlightPath:function(callback){return Animator.console?void 0:"webgl"===Animator.renderingMode?Animator.renderFlightPath(callback,this):Animator.tweenFlightPath(callback,this)},tweenFlightPath:function(callback,$scope){var TweenMax=Animator.loadTweenMax();TweenMax.killAll();var game=$scope.y,top=200-game.pitchTarget.y,left=game.pitchTarget.x,breakTop=200-game.pitchInFlight.y,breakLeft=game.pitchInFlight.x,$baseballs=$(".baseball"),flightSpeed=1.3-.6*(game.pitchInFlight.velocity+300)/400,originTop=50,originLeft=110+("left"==game.pitcher["throws"]?20:-20),pitch=this.pitchTarget=$(".main-area .target .baseball.pitch"),henka=this.pitchBreak=$(".main-area .target .baseball.break"),quarter=flightSpeed/4,pitchTransition=_baseballServices_services.Mathinator.pitchTransition(top,left,originTop,originLeft,quarter,12,4),targetTransition=_baseballServices_services.Mathinator.pitchTransition(top,left,originTop,originLeft,quarter,10,3),transitions=[pitchTransition(0,0),pitchTransition(10,0),pitchTransition(30,1),pitchTransition(50,2),targetTransition(100,3),pitchTransition(100,3,breakTop,breakLeft)];TweenMax.set([pitch,henka],transitions[0]),TweenMax.to([pitch,henka],quarter,transitions[1]),TweenMax.to([pitch,henka],quarter,transitions[2]),TweenMax.to([pitch,henka],quarter,transitions[3]),TweenMax.to(pitch,quarter,transitions[4]),TweenMax.to(henka,quarter,transitions[5]),$scope.lastTimeout=setTimeout(function(){$scope.allowInput=!0,"function"==typeof callback&&(callback(),$scope.$apply())},1e3*flightSpeed),game.pitchInFlight.x?(game.humanBatting()&&180*Math.random()>game.batter.skill.offense.eye?$(".baseball.break").addClass("hide"):$(".baseball.break").removeClass("hide"),$(".baseball.pitch").removeClass("hide")):$baseballs.addClass("hide"),game.humanBatting()&&!game.humanPitching()&&$scope.holdUpTimeouts.push(setTimeout(function(){$scope.holdUp()},1e3*(flightSpeed+Animator.HOLD_UP_ALLOWANCE)))},renderFlightPath:function(callback,$scope){var TweenMax=Animator.loadTweenMax();TweenMax.killAll();var game=$scope.y,flightSpeed=_baseballServices_services.Mathinator.getFlightTime(game.pitchInFlight.velocity,_baseballUtilityHelper.helper.pitchDefinitions[game.pitchInFlight.name][2]);this.loop||this.beginRender();var ball=new this.loop.constructors.Ball;Animator._ball=ball,ball.derivePitchingTrajectory(game),ball.trajectory=ball.breakingTrajectory,ball.join(this.loop),$scope.lastTimeout=setTimeout(function(){$scope.allowInput=!0,"function"==typeof callback&&(callback(),$scope.$apply())},1e3*flightSpeed);var $baseballs=$(".baseball");$baseballs.addClass("hide"),game.humanBatting()&&!game.humanPitching()&&$scope.holdUpTimeouts.push(setTimeout(function(){$scope.holdUp()},1e3*(flightSpeed+Animator.HOLD_UP_ALLOWANCE)))},animateFieldingTrajectory:function(game){return Animator.console?game.swingResult:"webgl"===this.renderingMode?(Animator.tweenFieldingTrajectory(game,!0),Animator.renderFieldingTrajectory(game)):Animator.tweenFieldingTrajectory(game)},tweenFieldingTrajectory:function(game,splayOnly){var TweenMax=Animator.loadTweenMax(),ball=$(".splay-indicator-ball");TweenMax.killAll();var result=game.swingResult,linearApproximateDragScalar={distance:1,apexHeight:.57,airTime:.96},angle=result.flyAngle,distance=Math.abs(result.travelDistance),scalar=result.travelDistance<0?-1:1;_baseballServices_services.Mathinator.memory.bounding=0>angle,angle=1+Math.abs(angle),angle>90&&(angle=180-angle);var velocity=linearApproximateDragScalar.distance*Math.sqrt(9.81*distance/Math.sin(2*Math.PI*angle/180)),velocityVerticalComponent=Math.sin(_baseballServices_services.Mathinator.RADIAN*angle)*velocity,apexHeight=velocityVerticalComponent*velocityVerticalComponent/19.62*linearApproximateDragScalar.apexHeight,airTime=1.5*Math.sqrt(2*apexHeight/9.81)*linearApproximateDragScalar.airTime,quarter=airTime/4,mathinator=new _baseballServices_services.Mathinator,transitions=[mathinator.transitionalTrajectory(0,quarter,0,apexHeight,scalar*distance,result.splay),mathinator.transitionalTrajectory(25,quarter,0),mathinator.transitionalTrajectory(50,quarter,1),mathinator.transitionalTrajectory(75,quarter,2),mathinator.transitionalTrajectory(100,quarter,3)];if(TweenMax.set(ball,transitions[0]),TweenMax.to(ball,quarter,transitions[1]),TweenMax.to(ball,quarter,transitions[2]),TweenMax.to(ball,quarter,transitions[3]),TweenMax.to(ball,quarter,transitions[4]),!splayOnly){ball=$(".indicator.baseball.break").removeClass("hide").show();var time=quarter/2;transitions=[mathinator.transitionalCatcherPerspectiveTrajectory(0,time,0,apexHeight,scalar*distance,result.splay,game.pitchInFlight),mathinator.transitionalCatcherPerspectiveTrajectory(12.5,.75*time,0),mathinator.transitionalCatcherPerspectiveTrajectory(25,.8*time,1),mathinator.transitionalCatcherPerspectiveTrajectory(37.5,.85*time,2),mathinator.transitionalCatcherPerspectiveTrajectory(50,.9*time,3),mathinator.transitionalCatcherPerspectiveTrajectory(62.5,.95*time,4),mathinator.transitionalCatcherPerspectiveTrajectory(75,time,5),mathinator.transitionalCatcherPerspectiveTrajectory(87.5,time,6),mathinator.transitionalCatcherPerspectiveTrajectory(100,time,7)],TweenMax.set(ball,transitions[0]),TweenMax.to(ball,time,transitions[1]),TweenMax.to(ball,time,transitions[2]),TweenMax.to(ball,time,transitions[3]),TweenMax.to(ball,time,transitions[4]),TweenMax.to(ball,time,transitions[5]),TweenMax.to(ball,time,transitions[6]),TweenMax.to(ball,time,transitions[7]),TweenMax.to(ball,time,transitions[8]),setTimeout(function(){$(".indicator.baseball.break").removeClass("hide").show()},50)}return game.swingResult},renderFieldingTrajectory:function(game){this.loop||this.beginRender();var result=game.swingResult,ball=Animator._ball||new this.loop.constructors.Ball;return ball.deriveTrajectory(result,game.pitchInFlight),ball.join(this.loop),result.thrownOut||result.caught||result.bases?Math.random()<.15&&ball.airTime>1.5||Math.random()<.5&&ball.airTime>2.5?(this.loop.setLookTarget(ball.mesh.position,.3),this.loop.setOverwatchMoveTarget(ball.mesh.position,.16)):(this.loop.setLookTarget(ball.mesh.position,.5),this.loop.setMoveTarget({x:0,y:6,z:_baseballRenderLoop.Loop.INITIAL_CAMERA_DISTANCE},.05)):Math.abs(result.splay)<60&&(this.loop.setLookTarget(ball.mesh.position,.5),this.loop.setMoveTarget({x:0,y:6,z:_baseballRenderLoop.Loop.INITIAL_CAMERA_DISTANCE},.05)),game.swingResult}};for(var fn in Animator.prototype)Animator.prototype.hasOwnProperty(fn)&&(Animator[fn]=Animator.prototype[fn]);exports.Animator=Animator},{"baseball/Render/Loop":9,"baseball/Utility/helper":35,"baseball/services/_services":39}],25:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _baseballUtilityHelper=require("baseball/Utility/helper"),pitchDefinitions=_baseballUtilityHelper.helper.pitchDefinitions,Distribution=function(){},random=Math.random,min=Math.min,max=Math.max,floor=Math.floor,abs=(Math.ceil,Math.abs),pow=Math.pow,sqrt=Math.sqrt;Distribution.prototype={identifier:"Distribution",constructor:Distribution,chance:function(scale){return scale||(scale=1),random()*scale},error:function(fielder){return.1*(100-fielder.skill.defense.fielding)+3.25>100*random()},landingDistance:function(power,flyAngle,x,y){x=min(5,0|abs(x)),y=min(5,0|abs(y));var goodContactBonus=8-sqrt(x*x+y*y),scalar=pow(random(),1-.125*goodContactBonus);return(10+320*scalar+power/300+random()*power/75*150)*(1-abs(flyAngle-30)/60)},pitchLocation:function(count){var x,y;x=random()<.5?50+floor(90*random())-floor(30*random()):150+floor(30*random())-floor(90*random()),y=30+(170-floor(sqrt(28900*random())));var sum=count.strikes+count.balls+3;return x=((3+count.strikes)*x+100*count.balls)/sum,y=((3+count.strikes)*y+100*count.balls)/sum,{x:x,y:y}},centralizedNumber:function(){return 100+floor(15*random())-floor(15*random())},swingLikelihood:function swingLikelihood(eye,x,y,umpire){var swingLikelihood=(200-abs(100-x)-abs(100-y))/2;return swingLikelihood=60>x||x>140||50>y||y>150?(swingLikelihood+138-eye)/2-15*umpire.count.balls:(57+(2*swingLikelihood+eye)/3)/2,swingLikelihood-35+2*(umpire.count.balls+8*umpire.count.strikes)},pitchControl:function(target,control){var effect=(50-100*random())/(1+control/100);return min(199.9,max(.1,target+effect))},breakEffect:function(pitch,pitcher,x,y){var effect={};return effect.x=floor(x+pitch.breakDirection[0]*(.5+.5*random()+pitcher.pitching[pitch.name]["break"]/200)),effect.y=floor(y+pitch.breakDirection[1]*((.5+.5*random()+pitcher.pitching[pitch.name]["break"]/200)/(.5+y/200))),effect},cpuSwing:function(target,actual,eye){return eye=min(eye,100),100+(target-100)*(.5+random()*eye/200)-actual},swing:function(eye){return 100/(eye+25+50*random())},stealSuccess:function(pitch,catcher,thief,base,volitional){var rand=random(),rand2=random();4==base&&(rand/=100);var smoothedRand2=(1+rand2)/2,pitchBaseSpeedMultiplier=(pitchDefinitions[pitch.name]||["","",.6])[2];return(35*(0|volitional)+thief.skill.offense.eye+(-25*base+45))*rand+10+2*thief.skill.offense.speed-thief.fatigue>pitchBaseSpeedMultiplier*pitch.velocity*smoothedRand2+(catcher.skill.defense.catching+catcher.skill.defense.throwing)*rand2},willSteal:function(pitch,catcher,thief,base){return 4==base?!1:random()<.15&&this.stealSuccess(pitch,catcher,thief,base,!1)&&random()<.5}};for(var fn in Distribution.prototype)Distribution.prototype.hasOwnProperty(fn)&&(Distribution[fn]=Distribution.prototype[fn]);Distribution.main=function(){for(var ump={count:{balls:0,strikes:0}};ump.count.balls<4;){for(;ump.count.strikes<3;)console.log("S",ump.count.strikes,"B",ump.count.balls),console.log("middle",[15,35,55,75,95].map(function(x){return 0|Distribution.swingLikelihood(x,100,100,ump)})),console.log("corner",[15,35,55,75,95].map(function(x){return 0|Distribution.swingLikelihood(x,50,50,ump)})),console.log("ball",[15,35,55,75,95].map(function(x){return 0|Distribution.swingLikelihood(x,15,15,ump)})),ump.count.strikes++;ump.count.balls++,ump.count.strikes=0}},exports.Distribution=Distribution},{"baseball/Utility/helper":35}],26:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Iterator=function(){};Iterator.prototype={identifier:"Iterator",constructor:Iterator,each:function(collection,map){var keys,i;if(collection instanceof Array)for(i=0;i<collection.length;i++)map(i,collection[i]);else for(keys=Object.keys(collection),i=0;i<keys.length;i++)map(keys[i],collection[keys[i]])}};for(var fn in Iterator.prototype)Iterator.prototype.hasOwnProperty(fn)&&(Iterator[fn]=Iterator.prototype[fn]);exports.Iterator=Iterator},{}],27:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Mathinator=function(){};Mathinator.square=function(n){return n*n},Mathinator.prototype={identifier:"Mathinator",constructor:Mathinator,RADIAN:Math.PI/180,SPLAY_INDICATOR_LEFT:-4,getAngularOffset:function(offset,angle){var xScalar=offset.x<0?-1:1,yScalar=offset.y<0?-1:1,originalAngle=Math.atan(offset.x/offset.y)/this.RADIAN,distance=Math.sqrt(offset.x*offset.x+offset.y*offset.y),angledY=yScalar*Math.cos((angle-originalAngle)*this.RADIAN)*distance,angledX=xScalar*Math.sqrt(distance*distance-angledY*angledY);return{x:angledX,y:angledY}},getPolarDistance:function(a,b){var radians=this.RADIAN;return Math.sqrt(a[1]*a[1]+b[1]*b[1]-2*a[1]*b[1]*Math.cos(a[0]*radians-b[0]*radians))},battingAngle:function(origin,target){return Math.atan((origin.y-target.y)/(target.x-origin.x))/Math.PI*125},memory:{},transitionalTrajectory:function(percent,quarter,step,givenApexHeight,givenDistance,givenSplayAngle){givenApexHeight&&(Mathinator.prototype.memory.apexHeight=givenApexHeight),givenDistance&&(Mathinator.prototype.memory.distance=givenDistance),givenSplayAngle&&(Mathinator.prototype.memory.splay=givenSplayAngle);var bottom,left,padding,borderWidth,apexHeight=Mathinator.prototype.memory.apexHeight,distance=Mathinator.prototype.memory.distance,splay=Mathinator.prototype.memory.splay,bounding=Mathinator.prototype.memory.bounding,radian=this.RADIAN;bounding&&(quarter*=4,percent=Math.floor(100*Math.sqrt(percent/100))),bottom=Math.cos(splay*radian)*percent/100*distance*95/300,left=Math.sin(splay*radian)*percent/100*distance*95/300+this.SPLAY_INDICATOR_LEFT;var apexRatio=Math.sqrt((50-Math.abs(percent-50))/100)*(1/.7071);return bounding?(padding=1,borderWidth=1):(padding=apexRatio*apexHeight/90*15,borderWidth=2+2*apexRatio),bottom=Math.max(Math.min(bottom,400),-20),left=Math.max(Math.min(left,100),-100),padding=Math.max(Math.min(padding,12),0),{bottom:bottom,left:left,padding:padding,borderWidth:borderWidth,delay:quarter*step,ease:bounding?Power4.easeOut:Linear.easeNone}},transitionalCatcherPerspectiveTrajectory:function(percent,quarter,step,givenApexHeight,givenDistance,givenSplayAngle,givenOrigin){var memory=Mathinator.prototype.memory;givenApexHeight&&(memory.apexHeight=givenApexHeight),givenDistance&&(memory.distance=givenDistance),givenSplayAngle&&(memory.splay=givenSplayAngle),givenOrigin&&(memory.origin=givenOrigin);var top,left,padding,borderWidth,apexHeight=memory.apexHeight,distance=memory.distance,splay=memory.splay,origin=memory.origin,bounding=Mathinator.prototype.memory.bounding,radian=this.RADIAN;bounding&&(percent=Math.floor(100*Math.sqrt(percent/100)));var height=apexHeight-Math.pow(Math.abs(50-percent)/50,1.2)*apexHeight,currentDistance=distance*percent/100,projection=Math.pow((500-currentDistance)/500,2);return top=200-origin.y-20*height*projection+percent/100*(origin.y-85)*projection,left=origin.x+Math.sin(splay*radian)*(8*currentDistance)*projection,padding=12*projection*projection,borderWidth=Math.max(Math.min(padding/3,4),0),top=Math.max(Math.min(top,500),-1e4),left=Math.max(Math.min(left,1e4),-1e4),padding=Math.max(Math.min(padding,24),1),{top:top,left:left,padding:padding,borderWidth:borderWidth,delay:quarter*step,ease:bounding?Power4.easeOut:Linear.easeNone}},translateSwingResultToStylePosition:function(swingResult){var bottom,left;return bottom=Math.cos(swingResult.splay/180*Math.PI)*swingResult.travelDistance*95/300,left=Math.sin(swingResult.splay/180*Math.PI)*swingResult.travelDistance*95/300+this.SPLAY_INDICATOR_LEFT,bottom=Math.max(Math.min(bottom,400),-20),left=Math.max(Math.min(left,100),-100),swingResult.bottom=bottom+"px",swingResult.left=left+"px",swingResult},pitchTransition:function(top,left,originTop,originLeft,quarter,maxPadding,maxBorderWidth){return function(percent,step,breakTop,breakLeft){var _top,_left;_top=breakTop||top,_left=breakLeft||left,_top=originTop+Mathinator.square(percent/100)*(_top-originTop),1==step&&(_top-=2),2==step&&(_top-=1),_left=originLeft+Mathinator.square(percent/100)*(_left-originLeft);var padding=Math.max(Mathinator.square(percent/100)*maxPadding,1),borderWidth=Math.max(Mathinator.square(percent/100)*maxBorderWidth,1);return{top:_top,left:_left,padding:padding+"px",borderWidth:borderWidth+"px",transform:"translateZ(0)",delay:quarter*step,ease:Linear.easeNone}}},fielderReturnDelay:function(distance,throwing,fielding,intercept){return distance/90+5*(distance/310)*Math.min(intercept-120,0)/-240+1-(.2+.8*fielding)+distance/90/(.5+throwing/2)},infieldThrowDelay:function(player){var fielding=player.skill.defense.fielding,throwing=player.skill.defense.throwing;return 3.5-(fielding+throwing)/200},baseRunningTime:function(speed){return 7-speed/100*4.1},getSplayAndFlyAngle:function(x,y,angle,eye){var splay=-1.5*x-y*angle/20,direction=splay>0?1:-1;return splay+=direction*Math.random()*40*(100/(50+eye)),{splay:splay,fly:-3*y/((Math.abs(angle)+25)/35)}},getFlightTime:function(velocityRating,velocityScalar){return(1.3-.6*(velocityRating+300)/400)/velocityScalar}};for(var fn in Mathinator.prototype)Mathinator.prototype.hasOwnProperty(fn)&&(Mathinator[fn]=Mathinator.prototype[fn]);exports.Mathinator=Mathinator},{}],28:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _baseballServicesAnimator=require("baseball/Services/Animator"),_baseballServicesDistribution=require("baseball/Services/Distribution"),_baseballServicesIterator=require("baseball/Services/Iterator"),_baseballServicesMathinator=require("baseball/Services/Mathinator");exports.Animator=_baseballServicesAnimator.Animator,exports.Distribution=_baseballServicesDistribution.Distribution,exports.Iterator=_baseballServicesIterator.Iterator,exports.Mathinator=_baseballServicesMathinator.Mathinator},{"baseball/Services/Animator":24,"baseball/Services/Distribution":25,"baseball/Services/Iterator":26,"baseball/Services/Mathinator":27}],29:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_TeamJapan=require("./TeamJapan"),Provider=function(){function Provider(){_classCallCheck(this,Provider)}return _createClass(Provider,[{key:"assignTeam",value:function(game,team,side){var special=this.teams[team];special.game=game,game.teams[side]=special}}]),Provider}();Provider.prototype.teams={TeamJapan:_TeamJapan.samurai},exports.Provider=Provider},{"./TeamJapan":30}],30:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _baseballModel_models=require("baseball/Model/_models"),_baseballModelPlayer=require("baseball/Model/Player"),_baseballTeamsTrainer=require("baseball/Teams/Trainer"),samurai=new _baseballModel_models.Team("no init");samurai.name="Japan",samurai.nameJ="日本";var darvish=new _baseballModelPlayer.Player(samurai),johjima=new _baseballModelPlayer.Player(samurai),ogasawara=new _baseballModelPlayer.Player(samurai),nishioka=new _baseballModelPlayer.Player(samurai),kawasaki=new _baseballModelPlayer.Player(samurai),murata=new _baseballModelPlayer.Player(samurai),matsui=new _baseballModelPlayer.Player(samurai),ichiro=new _baseballModelPlayer.Player(samurai),inaba=new _baseballModelPlayer.Player(samurai),matsuzaka=new _baseballModelPlayer.Player(samurai),fukudome=new _baseballModelPlayer.Player(samurai),aoki=new _baseballModelPlayer.Player(samurai),abe=new _baseballModelPlayer.Player(samurai),iwamura=new _baseballModelPlayer.Player(samurai),coach=new _baseballTeamsTrainer.Trainer;coach.makePlayer(darvish,"Yu","Darvish","ダルビッシュ","有",150,{eye:80,power:80,speed:80},{catching:50,fielding:70,throwing:100,speed:80},"right","right",11),coach.makePlayer(johjima,"Kenji","Johjima","城島","健司",60,{eye:90,power:88,speed:70},{catching:140,fielding:95,throwing:88,speed:94},"right","right",2),coach.makePlayer(ogasawara,"Michihiro","Ogasawara","小笠原","道大",80,{eye:96,power:115,speed:90},{catching:50,fielding:96,throwing:85,speed:70},"left","right",36),coach.makePlayer(nishioka,"Tsuyoshi","Nishioka","西岡","剛",80,{eye:88,power:75,speed:92},{catching:90,fielding:88,throwing:88,speed:90},"right","right",7),coach.makePlayer(kawasaki,"Munenori","Kawasaki","川崎","宗則",80,{eye:95,power:75,speed:92},{catching:90,fielding:98,throwing:90,speed:110},"left","right",52),coach.makePlayer(murata,"Shuichi","Murata","村田","修一",80,{eye:82,power:110,speed:60},{catching:80,fielding:80,throwing:90,speed:90},"right","right",25),coach.makePlayer(matsui,"Hideki","Matsui","秀樹","松井",75,{eye:104,power:130,speed:68},{catching:40,fielding:85,throwing:70,speed:60},"left","right",55),coach.makePlayer(ichiro,"","Ichiro","イチロー","",115,{eye:115,power:48,speed:99},{catching:80,fielding:110,throwing:135,speed:120},"left","right",51),coach.makePlayer(inaba,"Atsunori","Inaba","稲葉","篤紀",80,{eye:92,power:95,speed:75},{catching:50,fielding:95,throwing:95,speed:90},"right","right",41),samurai.bench=[darvish,johjima,ogasawara,nishioka,kawasaki,murata,matsui,ichiro,inaba,matsuzaka,fukudome,aoki,abe,iwamura],samurai.manager.makeLineup(),samurai.positions={pitcher:darvish,catcher:johjima,first:ogasawara,second:nishioka,"short":kawasaki,third:murata,left:matsui,center:ichiro,right:inaba};for(var position in samurai.positions)samurai.positions.hasOwnProperty(position)&&(samurai.positions[position].position=position);samurai.lineup=[ichiro,kawasaki,inaba,matsui,ogasawara,johjima,murata,nishioka,darvish],samurai.lineup.map(function(player,order){player.order=order}),exports.samurai=samurai},{"baseball/Model/Player":5,"baseball/Model/_models":8,"baseball/Teams/Trainer":31}],31:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_baseballServicesIterator=require("baseball/Services/Iterator"),Trainer=function(){function Trainer(){_classCallCheck(this,Trainer)}return _createClass(Trainer,[{key:"makePlayer",value:function(player,name,surname,surnameJ,nameJ,pitching,offense,defense,bats,throws,number){player.hero=!0,player.name=name+" "+surname,player.nameJ=surnameJ+nameJ,player.surname=surname,player.surnameJ=surnameJ,player.spaceName(surnameJ,nameJ),player.randomizeSkills(!0,!0),player.skill.offense=offense,player.skill.defense=defense,player.skill.pitching=pitching,player.bats=bats,player["throws"]=throws,player.number=number,_baseballServicesIterator.Iterator.each(player.pitching,function(key,value){player.pitching[key].velocity+=pitching/5|0,player.pitching[key]["break"]+=pitching/5|0,player.pitching[key].control+=pitching/5|0}),player.resetStats(0)}}]),Trainer}();exports.Trainer=Trainer},{"baseball/Services/Iterator":26}],32:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _baseballUtilityText=require("baseball/Utility/text"),Log=function(){this.init()};Log.prototype={game:"instance of Game",init:function(){this.stabilized={pitchRecord:{e:["","","","","",""],n:["","","","","",""]},shortRecord:{e:["","","","","",""],n:["","","","","",""]}},this.pitchRecord={e:[],n:[]},this.shortRecord={e:[],n:[]},this.record={e:[],n:[]}},SINGLE:"H",DOUBLE:"2B",TRIPLE:"3B",HOMERUN:"HR",WALK:"BB",GROUNDOUT:"GO",FLYOUT:"FO",LINEOUT:"LO",RUN:"R",STRIKEOUT:"SO",SACRIFICE:"SAC",REACHED_ON_ERROR:"ROE",FIELDERS_CHOICE:"FC",GIDP:"(IDP)",GITP:"(ITP)",STOLEN_BASE:"SB",CAUGHT_STEALING:"CS",stabilizeShortRecord:function(){var rec=this.record.e.slice(0,6);this.shortRecord.e=rec,this.stabilized.shortRecord.e=rec.concat(["","","","","",""]).slice(0,6);var rec2=this.record.n.slice(0,6);this.shortRecord.n=rec2,this.stabilized.shortRecord.n=rec2.concat(["","","","","",""]).slice(0,6)},note:function(_note,noteJ,only){"e"===only?(this.record.e.unshift(_note),this.async(function(){console.log(_note)})):"n"===only?(this.record.n.unshift(noteJ),this.async(function(){console.log(noteJ)})):(this.record.e.unshift(_note),this.record.n.unshift(noteJ),this.async(function(){"n"===_baseballUtilityText.text.mode?console.log(noteJ):console.log(_note)})),this.stabilizeShortRecord()},getBatter:function(batter){var order=batter.team.nowBatting;order={0:_baseballUtilityText.text(" 1st"),1:_baseballUtilityText.text(" 2nd"),2:_baseballUtilityText.text(" 3rd"),3:_baseballUtilityText.text(" 4th"),4:_baseballUtilityText.text(" 5th"),5:_baseballUtilityText.text(" 6th"),6:_baseballUtilityText.text(" 7th"),7:_baseballUtilityText.text(" 8th"),8:_baseballUtilityText.text(" 9th")}[order];var positions=this.longFormFielder();return _baseballUtilityText.text("Now batting")+order+_baseballUtilityText.text.comma()+positions[batter.position]+_baseballUtilityText.text.comma()+batter.getUniformNumber()+_baseballUtilityText.text.comma()+batter.getName()},noteBatter:function(batter){var record,recordJ,m=_baseballUtilityText.text.mode;_baseballUtilityText.text.mode="e",record=this.getBatter(batter),_baseballUtilityText.text.mode="n",
recordJ=this.getBatter(batter),_baseballUtilityText.text.mode=m,this.note(record,recordJ)},getPitchLocationDescription:function(pitchInFlight,batterIsLefty){var x=pitchInFlight.x,y=pitchInFlight.y,say="",noComma=!1,noComma2=!1,ball=!1;return batterIsLefty||(x=200-x),50>x?(say+=_baseballUtilityText.text("way outside"),ball=!0):70>x?say+=_baseballUtilityText.text("outside"):100>x?(say+="",noComma=!0):130>x?(say+="",noComma=!0):150>x?say+=_baseballUtilityText.text("inside"):(say+=_baseballUtilityText.text("way inside"),ball=!0),""!=say&&(say+=_baseballUtilityText.text.comma()),35>y?(say+=_baseballUtilityText.text("way low"),ball=!0):65>y?say+=_baseballUtilityText.text("low"):135>y?(say+="",noComma2=!0):165>y?say+=_baseballUtilityText.text("high"):(say+=_baseballUtilityText.text("way high"),ball=!0),(noComma||noComma2)&&(say=say.split(_baseballUtilityText.text.comma()).join(""),noComma&&noComma2&&(say=_baseballUtilityText.text("down the middle"))),say=_baseballUtilityText.text.namePitch(pitchInFlight)+_baseballUtilityText.text.comma()+say+_baseballUtilityText.text.stop()},notePitch:function(pitchInFlight,batter){var record,recordJ,m=_baseballUtilityText.text.mode;_baseballUtilityText.text.mode="e",record=this.getPitchLocationDescription(pitchInFlight,"left"==batter.bats),this.pitchRecord.e.unshift(record),this.stabilized.pitchRecord.e.unshift(record),this.stabilized.pitchRecord.e.pop(),_baseballUtilityText.text.mode="n",recordJ=this.getPitchLocationDescription(pitchInFlight,"left"==batter.bats),this.pitchRecord.n.unshift(recordJ),this.stabilized.pitchRecord.n.unshift(recordJ),this.stabilized.pitchRecord.n.pop(),_baseballUtilityText.text.mode=m},broadcastCount:function(justOuts){if(!this.game.umpire)return"";var count=this.game.umpire.count;if(2==this.lastOuts&&0==count.outs)outs=3+_baseballUtilityText.text(" outs");else var outs=count.outs+(1==count.outs?_baseballUtilityText.text(" out"):_baseballUtilityText.text(" outs"));return this.lastOuts=count.outs,justOuts?outs+_baseballUtilityText.text.stop():count.strikes+"-"+count.balls+", "+outs+_baseballUtilityText.text.stop()},broadcastScore:function(){return this.game.teams.away.getName()+" "+this.game.tally.away.R+", "+this.game.teams.home.getName()+" "+this.game.tally.home.R+_baseballUtilityText.text.stop()},broadcastRunners:function(){var field=this.game.field,runners=[field.first&&_baseballUtilityText.text("first")||"",field.second&&_baseballUtilityText.text("second")||"",field.third&&_baseballUtilityText.text("third")||""].filter(function(x){return x}),runnerCount=0;switch(runners.map(function(runner){runner&&runnerCount++}),runnerCount){case 0:return _baseballUtilityText.text("Bases empty")+_baseballUtilityText.text.stop();case 1:return _baseballUtilityText.text("Runner on")+": "+runners.join(_baseballUtilityText.text.comma())+_baseballUtilityText.text.stop();default:return _baseballUtilityText.text("Runners on")+": "+runners.join(_baseballUtilityText.text.comma())+_baseballUtilityText.text.stop()}},getSwing:function(swingResult){var result="";result+=swingResult.looking?swingResult.strike?_baseballUtilityText.text("Strike."):_baseballUtilityText.text("Ball."):swingResult.contact?swingResult.foul?_baseballUtilityText.text("Fouled off."):swingResult.caught?_baseballUtilityText.text("In play."):swingResult.thrownOut?_baseballUtilityText.text("In play."):_baseballUtilityText.text("In play."):_baseballUtilityText.text("Swinging strike.");var steal="";return swingResult.stoleABase&&(steal=this.noteStealAttempt(swingResult.stoleABase,!0,swingResult.attemptedBase)),swingResult.caughtStealing&&(steal=this.noteStealAttempt(swingResult.caughtStealing,!1,swingResult.attemptedBase)),steal&&this.note(steal,steal,_baseballUtilityText.text.mode),result+steal},noteSwing:function(swingResult){var record,recordJ,m=_baseballUtilityText.text.mode,pitchRecord=this.pitchRecord,stabilized=this.stabilized.pitchRecord;_baseballUtilityText.text.mode="e",record=this.getSwing(swingResult),pitchRecord.e[0]+=record,stabilized.e[0]+=record,_baseballUtilityText.text.mode="n",recordJ=this.getSwing(swingResult),pitchRecord.n[0]+=recordJ,stabilized.n[0]+=recordJ,_baseballUtilityText.text.mode=m,recordJ=stabilized.n[0],record=stabilized.e[0];var giraffe=this;0!==record.indexOf("Previous")&&this.async(function(){record.indexOf("In play")>-1&&record.indexOf("struck out")>-1?"n"===_baseballUtilityText.text.mode?console.log(recordJ):console.log(record):"n"===_baseballUtilityText.text.mode?console.log(giraffe.broadcastCount(),recordJ):console.log(giraffe.broadcastCount(),record)})},async:function(fn){this.game.console||this.game.quickMode||setTimeout(fn,100)},noteStealAttempt:function(thief,success,base){return _baseballUtilityText.text.space()+thief.getName()+_baseballUtilityText.text.comma()+(success?_baseballUtilityText.text("stolen base"):_baseballUtilityText.text("caught stealing"))+_baseballUtilityText.text.space()+"("+_baseballUtilityText.text.baseShortName(base)+")"+_baseballUtilityText.text.stop()},noteSubstitution:function(sub,player){return this.note(_baseballUtilityText.text.substitution(sub,player,"e"),_baseballUtilityText.text.substitution(sub,player,"n"))},getPlateAppearanceResult:function(game){var r=game.swingResult,record="",batter=game.batter.getName(),out=[];if(r.looking){record=r.strike?batter+_baseballUtilityText.text(" struck out looking."):batter+_baseballUtilityText.text(" walked.");var steal="";r.stoleABase&&(steal=this.noteStealAttempt(r.stoleABase,!0,r.attemptedBase)),r.caughtStealing&&(steal=this.noteStealAttempt(r.caughtStealing,!1,r.attemptedBase)),record+=steal}else if(r.contact){var outBy,fielder=r.fielder,bases=r.bases;if(r.caught)outBy=r.flyAngle<15?"line":["left","center","right"].indexOf(r.fielder)<0?"pop":"fly";else if(r.foul);else if(r.error)bases=1,outBy="error";else{if(r.thrownOut)outBy=Math.random()<.5?"ground":"thrown";else switch(r.bases){case 1:case 2:case 3:bases=r.bases;break;case 4:bases=4,fielder=r.splay<-15?"left":r.splay<15?"center":"right"}r.firstOut&&(out=out.concat(r.additionalOuts.filter(function(runner){return"batter"!==runner})),out.doublePlay=r.doublePlay),r.fieldersChoice&&(out.push(r.fieldersChoice),outBy=3==r.outs?"ground":"fieldersChoice")}record=_baseballUtilityText.text.contactResult(batter,fielder,bases,outBy,3===r.outs?[]:r.sacrificeAdvances,out)}else record=batter+_baseballUtilityText.text(" struck out swinging.");return record},notePlateAppearanceResult:function(game){var statement,m=_baseballUtilityText.text.mode,prevJ=_baseballUtilityText.text("Previous: ","n"),prev=_baseballUtilityText.text("Previous: ","e"),record=this.record,pitchRecord=this.pitchRecord,stabilized=this.stabilized.pitchRecord;_baseballUtilityText.text.mode="e";var result=this.getPlateAppearanceResult(game);record.e.unshift(result),statement=prev+result,pitchRecord.e=[statement],stabilized.e=[statement,"","","","",""],_baseballUtilityText.text.mode="n";var resultJ=this.getPlateAppearanceResult(game);record.n.unshift(resultJ),statement=prevJ+resultJ,pitchRecord.n=[statement],stabilized.n=[statement,"","","","",""],_baseballUtilityText.text.mode=m;var giraffe=this;this.async(function(){"n"===_baseballUtilityText.text.mode?console.log(["%c"+resultJ,giraffe.broadcastCount(!0),giraffe.broadcastScore(),giraffe.broadcastRunners()].join(" "),"color: darkgreen;"):console.log(["%c"+result,giraffe.broadcastCount(!0),giraffe.broadcastScore(),giraffe.broadcastRunners()].join(" "),"color: darkgreen;")})},pointer:0,stabilized:{pitchRecord:{e:["","","","","",""],n:["","","","","",""]},shortRecord:{e:["","","","","",""],n:["","","","","",""]}},pitchRecord:{e:[],n:[]},shortRecord:{e:[],n:[]},record:{e:[],n:[]},longFormFielder:function(){return{first:_baseballUtilityText.text("first baseman"),second:_baseballUtilityText.text("second baseman"),third:_baseballUtilityText.text("third baseman"),"short":_baseballUtilityText.text("shortstop"),pitcher:_baseballUtilityText.text("pitcher"),catcher:_baseballUtilityText.text("catcher"),left:_baseballUtilityText.text("left fielder"),center:_baseballUtilityText.text("center fielder"),right:_baseballUtilityText.text("right fielder")}}},exports.Log=Log},{"baseball/Utility/text":36}],33:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _baseballUtilityData=require("baseball/Utility/data"),_baseballUtilityHelper=require("baseball/Utility/helper"),_baseballUtilityLog=require("baseball/Utility/Log"),_baseballUtilityText=require("baseball/Utility/text");exports.data=_baseballUtilityData.data,exports.helper=_baseballUtilityHelper.helper,exports.Log=_baseballUtilityLog.Log,exports.text=_baseballUtilityText.text},{"baseball/Utility/Log":32,"baseball/Utility/data":34,"baseball/Utility/helper":35,"baseball/Utility/text":36}],34:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var data={surnames:["Sato","Suzuki","Takahashi","Tanaka","Watanabe","Ito","Nakamura","Kobayashi","Yamamoto","Kato","Yoshida","Yamada","Sasaki","Yamaguchi","Matsumoto","Inoue","Kimura","Shimizu","Hayashi","Saito","Saito","Yamazaki","Nakajima","Mori","Abe","Ikeda","Hashimoto","Ishikawa","Yamashita","Ogawa","Ishii","Hasegawa","Goto","Okada","Kondo","Maeda","Fujita","Endo","Aoki","Sakamoto","Murakami","Ota","Kaneko","Fujii","Fukuda","Nishimura","Miura","Takeuchi","Nakagawa","Okamoto","Matsuda","Harada","Nakano"],surnamesJ:["佐藤","鈴木","高橋","田中","渡辺","伊藤","中村","小林","山本","加藤","吉田","山田","佐々木","山口","松本","井上","木村","清水","林","斉藤","斎藤","山崎","中島","森","阿部","池田","橋本","石川","山下","小川","石井","長谷川","後藤","岡田","近藤","前田","藤田","遠藤","青木","坂本","村上","太田","金子","藤井","福田","西村","三浦","竹内","中川","岡本","松田","原田","中野"],namesJ:["匠","ヒカル","ゆうき","翔太","冬馬","漣","港区","ルイ","樹","賢治","五木","春","光一","宗介","こうすけ","雄太","大樹","瑛太","宏","亨","道夫","聡","昭","茂雄","勝","純一","和夫","勲","省三","隆","達夫","正一","輝夫","俊夫","史郎","勇","義弘","良雄","登","義明","正義","秀夫","肇","月","克己","正男","光男","久","耕三","清","次郎","正博","明子","武","勉","晴夫","裕二","稔","障子","和子","敦","茂","信夫","恵一","忠","高尾","薫","ケン","健治","哲夫","啓二","光一","真一","貞夫","靖","武","雄","文雄","久雄","一朗","健一","正明","五郎","誠","昭夫","誠司","洋一","康夫","誠一","正美","則夫","幸雄","忠雄","仁","シンジ","豊","邦雄","修","雅之","三郎","英治","浩二","栄一","恒夫","義郎","進","博之","巌"],names:["Takumi","Hikaru","Yuuki","Shouta","Touma","Ren","Minato","Rui","Tatsuki","Kenji","Itsuki","Haru","Kouichi","Sousuke","Kousuke","Yuuta","Daiki","Eita","Hiroshi","Toru","Michio","Satoshi","Akira","Shigeo","Masaru","Junichi","Kazuo","Isao","Shozo","Takashi","Tatsuo","Shoichi","Teruo","Toshio","Shiro","Isamu","Yoshihiro","Yoshio","Noboru","Yoshiaki","Tadayoshi","Hideo","Hajime","Akari","Katsumi","Masao","Mitsuo","Hisashi","Kozo","Kiyoshi","Jiro","Masahiro","Akiko","Takeshi","Tsutomu","Haruo","Yuji","Minoru","Shoji","Kazuko","Atsushi","Shigeru","Shinobu","Keiichi","Tadashi","Takao","Kaoru","Ken","Kenji","Tetsuo","Keiji","Koichi","Shinichi","Sadao","Yasushi","Takeshi","Yu","Fumio","Hisao","Ichiro","Kenichi","Masaaki","Goro","Makoto","Akio","Seiji","Yoichi","Yasuo","Seiichi","Masami","Norio","Yukio","Tadao","Hitoshi","Shinji","Yutaka","Kunio","Osamu","Masayuki","Saburo","Eiji","Koji","Eiichi","Tsuneo","Yoshio","Susumu","Hiroyuki","Iwao"],teamNamesJ:["横浜","大阪","名古屋","札幌","神戸","京都","福岡","川崎","埼玉県","広島","仙台","千葉県","新潟","浜松","静岡","相模原","岡山","熊本","鹿児島","船橋","川口","姫路","松山","宇都宮","松戸","西宮","倉敷","市川","福山","尼崎","金沢","長崎","横須賀","富山","高松","町田","岐阜","枚方","藤沢","柏","豊中","長野県","豊橋","一宮","和歌山","岡崎","宮崎","奈良","吹田","高槻","旭川","いわき","高崎","所沢","川越","秋田","越谷","前橋","那覇","四日市","青森","久留米","春日井","盛岡","明石","福島","下関","長岡","市原","函館","茨城県","福井","加古川","徳島","水戸","平塚","佐世保","呉","八戸","佐賀","寝屋川","富士","春日部","茅ヶ崎","松本","厚木","大和","上尾","宝塚","筑波","沼津","熊谷","伊勢崎","岸和田","鳥取","小田原","鈴鹿","松江","日立"],teamNames:["Yokohama","Osaka","Nagoya","Sapporo","Kobe","Kyoto","Fukuoka","Kawasaki","Saitama","Hiroshima","Sendai","Chiba","Niigata","Hamamatsu","Shizuoka","Sagamihara","Okayama","Kumamoto","Kagoshima","Funabashi","Kawaguchi","Himeji","Matsuyama","Utsunomiya","Matsudo","Nishinomiya","Kurashiki","Ichikawa","Fukuyama","Amagasaki","Kanazawa","Nagasaki","Yokosuka","Toyama","Takamatsu","Machida","Gifu","Hirakata","Fujisawa","Kashiwa","Toyonaka","Nagano","Toyohashi","Ichinomiya","Wakayama","Okazaki","Miyazaki","Nara","Suita","Takatsuki","Asahikawa","Iwaki","Takasaki","Tokorozawa","Kawagoe","Akita","Koshigaya","Maebashi","Naha","Yokkaichi","Aomori","Kurume","Kasugai","Morioka","Akashi","Fukushima","Shimonoseki","Nagaoka","Ichihara","Hakodate","Ibaraki","Fukui","Kakogawa","Tokushima","Mito","Hiratsuka","Sasebo","Kure","Hachinohe","Saga","Neyagawa","Fuji","Kasukabe","Chigasaki","Matsumoto","Atsugi","Yamato","Ageo","Takarazuka","Tsukuba","Numazu","Kumagaya","Isesaki","Kishiwada","Tottori","Odawara","Suzuka","Matsue","Hitachi"]};exports.data=data},{}],35:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var helper={pitchDefinitions:{"4-seam":[0,0,1,180,1e3],"2-seam":[20,-20,.9,-45,1200],cutter:[-25,-20,.95,75,1200],sinker:[15,-30,.95,-45,1500],slider:[-50,-35,.88,80,2e3],fork:[0,-70,.87,20,500],curve:[0,-110,.82,10,2500],change:[0,-10,.86,-15,1e3]},selectRandomPitch:function(){return["4-seam","2-seam","cutter","sinker","slider","fork","curve","change"][Math.floor(8*Math.random())]}};exports.helper=helper},{}],36:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var text=function text(phrase,override){text.mode||(text.mode="n");var string={n:{empty:"-"," 1st":"1番"," 2nd":"2番"," 3rd":"3番"," 4th":"4番"," 5th":"5番"," 6th":"6番"," 7th":"7番"," 8th":"8番"," 9th":"9番","Now batting":"次のバッター","way outside":"相当外角",outside:"外角",inside:"内角","way inside":"相当内角","way low":"相当低め",low:"低め",high:"高め","way high":"相当高め","down the middle":"真ん中","first baseman":"ファースト","second baseman":"セカンド","third baseman":"サード",shortstop:"ショート",pitcher:"ピッチャー",catcher:"キャッチャー","left fielder":"レフト","center fielder":"センター","right fielder":"ライト","Strike.":"ストライク。","Ball.":"ボール。","Fouled off.":"ファウル。","In play.":"インプレー。","Swinging strike.":"空振り。"," outs":"アウト"," out":"アウト","4-seam":"ストレート","2-seam":"シュート",slider:"スライダー",fork:"フォーク",cutter:"カット",sinker:"シンカー",curve:"カーブ",change:"チェンジ"," struck out looking.":"、見逃し三振。"," walked.":"、フォアボール。"," struck out swinging.":"、空振り三振。","Previous: ":"前：","looks like: ":"予想","breaking ball":"変化球",fastball:"ストレート","Batting, ":"打球","Catching, pitch selection":"捕球選択",Season:"記録",Game:"今試合",Pitch:"球",Control:"制球",Velocity:"速度",Break:"変化","At Bat":"バッター","On Deck":"次バッター","Eye :":"目","Power :":"力","Speed :":"速","Up to Bat":"打席",Fielding:"守備",BA:"打率",OBP:"出塁",SLG:"長打",PA:"打席","H/2B/3B/HR":"安／二／三／本",H:"安","2B":"二","3B":"三",HR:"本塁打",RBI:"打点",R:"得点",BB:"四球",SO:"三振",first:"ファースト",second:"セカンド",third:"サード","Runner on":"ランナー","Runners on":"ランナー","Bases empty":"ランナーなし",base:"塁","stolen base":"盗塁成功","caught stealing":"盗塁失敗",Steal:"盗塁",Opportunistic:"自由",Hold:"止まれ","Select Language:":"言語","Run Fast Simulation":"シミュレーションを試合終了まで行う","Play Ball!":"プレーボール","Spectate the CPU":"CPU観戦","Play from the 7th":"７回からプレーする","Throws/Bats":" ",LHP:"左投",RHP:"右投",LHB:"左打",RHB:"右打",L:"左投","R ":"右投"," L ":"左打"," R ":"右打","#":"背番号","Opponent connected":"相手選手見参","Click Here":"ここにクリック","Play against Team Japan":"日本代表挑戦",Substituted:"交代"},e:{empty:"-",Season:"Season"}}[override?override:text.mode][phrase];return string?string:phrase};text.substitution=function(sub,player,mode){var originalMode=text.mode;mode=mode||text.mode;var order={0:text(" 1st",mode),1:text(" 2nd",mode),2:text(" 3rd",mode),3:text(" 4th",mode),4:text(" 5th",mode),5:text(" 6th",mode),6:text(" 7th",mode),7:text(" 8th",mode),8:text(" 9th",mode)}[player.order],position=text.fielderShortName(player.position,mode);if("n"===mode){text.mode="n";var output=sub.getName()+text.comma()+player.getName()+"の交代"+text.comma()+order+"("+position+")"}else text.mode="n",output=sub.getName()+" replaces "+player.getName()+" at "+position+", batting"+order;return text.mode=originalMode,output},text.getBattersEye=function(game){var eye={},breaking=Math.abs(game.pitchInFlight.breakDirection[0])+Math.abs(game.pitchInFlight.breakDirection[1])>40;return eye.e=text("looks like: ","e")+breaking?text("breaking ball","e"):text("fastball","e"),eye.n=text("looks like: ","n")+breaking?text("breaking ball","n"):text("fastball","n"),eye},text.baseShortName=function(base){return"n"==text.mode?{"1st":"一","2nd":"二","3rd":"三",home:"本",Home:"本",left:"左",center:"中",right:"右"}[base]:base},text.fielderShortName=function(fielder,override){var mode=override||text.mode;return"n"===mode?{first:"一",second:"二",third:"三","short":"遊",pitcher:"投",catcher:"捕",left:"左",center:"中",right:"右"}[fielder]:fielder},text.slash=function(){return"n"==text.mode?"・":"/"},text.fielderLongName=function(fielder){return"n"==text.mode?{first:"ファースト",second:"セカンド",third:"サード","short":"ショート",pitcher:"ピッチャー",catcher:"キャッチャー",left:"レフト",center:"センター",right:"ライト"}[fielder]:{first:text("first baseman"),second:text("second baseman"),third:text("third baseman"),"short":text("shortstop"),pitcher:text("pitcher"),catcher:text("catcher"),left:text("left fielder"),center:text("center fielder"),right:text("right fielder")}[fielder]},text.comma=function(){return{n:"、",e:", "}[text.mode]},text.space=function(){return{n:"",e:" "}[text.mode]},text.stop=function(){return{n:"。",e:". "}[text.mode]},text.namePitch=function(pitch){return"e"==text.mode?pitch.name.charAt(0).toUpperCase()+pitch.name.slice(1):"n"==text.mode?text(pitch.name):void 0},text.contactResult=function(batter,fielder,bases,outBy,sacrificeAdvances,out){var statement="",infield=["left","center","right"].indexOf(fielder)<0,doublePlay=out.doublePlay;if("e"==text.mode){if(statement+=batter,outBy){switch(outBy){case"fieldersChoice":play=2===out.length?"double play ":"",statement+=" reached on a fielder's choice "+play+"by "+text.fielderShortName(fielder);break;case"line":statement+=" lined out to "+text.fielderShortName(fielder);break;case"fly":statement+=" flew out to "+text.fielderShortName(fielder);break;case"error":statement+=" reached on error by "+text.fielderShortName(fielder);break;case"pop":statement+=" popped out to "+text.fielderShortName(fielder);break;case"ground":var play=doublePlay?"into a double play by":"out to";statement+=" grounded "+play+" "+text.fielderShortName(fielder);break;case"thrown":play=doublePlay?" on a double play":"",statement+=" was thrown out by "+text.fielderShortName(fielder)+play}if(out.length){var plural=out.length>1,runner=plural?"Runners":"Runner",is=plural?"are":"is";statement+=". "+runner+" from "+text(out.join(text.comma()))+" "+is+" out"}}else switch(bases){case 1:statement+=infield?" reached on an infield hit to "+text.fielderShortName(fielder):" reached on a single to "+text.fielderShortName(fielder);break;case 2:statement+=" doubled past "+text.fielderShortName(fielder);break;case 3:statement+=" tripled past "+text.fielderShortName(fielder);break;case 4:statement+=" homered to "+text.fielderShortName(fielder)}sacrificeAdvances&&sacrificeAdvances.map(function(base){statement+="third"==base?text.stop()+"Runner on third scores":text.stop()+"Runner on "+base+" advances"}),statement+=text.stop()}if("n"==text.mode){var stop=text.stop();if(statement+=batter+"は",outBy){var fielderLong=text.fielderLongName(fielder);switch(fielder=text.fielderShortName(fielder),outBy){case"fieldersChoice":statement+="野選("+fielder+")で出塁";break;case"line":statement+=fielder+"直";break;case"fly":statement+=fielder+"飛";break;case"error":statement+="エラー("+fielder+")で出塁";break;case"pop":statement+="ポップフライで"+fielder+"飛";break;case"ground":statement+=fielderLong+"ゴロに封殺";break;case"thrown":statement+=fielder+"ゴロ"}out.length&&(statement+="。"+out.map(function(runner){return text(runner)}).join(text.comma())+"ランナーはアウト"),doublePlay&&(statement+="。ゲッツー")}else switch(fielder=text.fielderShortName(fielder),bases){case 1:statement+=infield?"内野安打("+fielder+")で出塁":"安打("+fielder+")で出塁";break;case 2:statement+="二塁打（"+fielder+"）で出塁";break;case 3:statement+="三塁打（"+fielder+"）で出塁";break;case 4:statement+="本塁打（"+fielder+"）"}sacrificeAdvances&&sacrificeAdvances.map(function(base){statement+="third"==base?stop+"サードランナーホームイン":stop+text(base)+"ランナー進塁"}),statement+=stop}return statement},exports.text=text},{}],37:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _baseballNamespace=require("baseball/namespace");"object"==typeof window&&(window.Baseball=_baseballNamespace.Baseball),exports.Baseball=_baseballNamespace.Baseball},{"baseball/namespace":38}],38:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _baseballModelGame=(require("baseball/Model/AtBat"),require("baseball/Model/Field"),require("baseball/Model/Game")),_baseballModelPlayer=(require("baseball/Model/Manager"),require("baseball/Model/Player")),_baseballModelTeam=require("baseball/Model/Team"),_baseballUtility_utils=(require("baseball/Model/Umpire"),require("baseball/Utility/_utils")),_baseballServices_services=require("baseball/Services/_services"),_baseballTeamsProvider=require("baseball/Teams/Provider"),Baseball={};Baseball.model={},Baseball.model.Game=Baseball.Game=_baseballModelGame.Game,Baseball.model.Player=Baseball.Player=_baseballModelPlayer.Player,Baseball.model.Team=Baseball.Team=_baseballModelTeam.Team,Baseball.service={},Baseball.service.Animator=_baseballServices_services.Animator,Baseball.service.Distribution=_baseballServices_services.Distribution,Baseball.service.Iterator=_baseballServices_services.Iterator,Baseball.service.Mathinator=_baseballServices_services.Mathinator,Baseball.util={},Baseball.util.text=_baseballUtility_utils.text,Baseball.util.Log=_baseballUtility_utils.Log,Baseball.teams={},Baseball.teams.Provider=_baseballTeamsProvider.Provider,exports.Baseball=Baseball},{"baseball/Model/AtBat":1,"baseball/Model/Field":2,"baseball/Model/Game":3,"baseball/Model/Manager":4,"baseball/Model/Player":5,"baseball/Model/Team":6,"baseball/Model/Umpire":7,"baseball/Services/_services":28,"baseball/Teams/Provider":29,"baseball/Utility/_utils":33}],39:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _baseballServicesAnimator=require("baseball/Services/Animator"),_baseballServicesDistribution=require("baseball/Services/Distribution"),_baseballServicesIterator=require("baseball/Services/Iterator"),_baseballServicesMathinator=require("baseball/Services/Mathinator");exports.Animator=_baseballServicesAnimator.Animator,exports.Distribution=_baseballServicesDistribution.Distribution,exports.Iterator=_baseballServicesIterator.Iterator,exports.Mathinator=_baseballServicesMathinator.Mathinator},{"baseball/Services/Animator":24,"baseball/Services/Distribution":25,"baseball/Services/Iterator":26,"baseball/Services/Mathinator":27}]},{},[37]),IndexController=function($scope,socket){var text=Baseball.util.text,Game=Baseball.Game,Animator=Baseball.service.Animator;if(window.s=$scope,$scope.t=text,$scope.mode=function(setMode){return setMode&&(text.mode=setMode,localStorage&&(localStorage.__$yakyuuaikoukai_text_mode=setMode)),text.mode},localStorage){var mode=localStorage.__$yakyuuaikoukai_text_mode;("e"===mode||"n"===mode)&&$scope.mode(mode)}$scope.teamJapan=function(){var provider=new Baseball.teams.Provider;provider.assignTeam($scope.y,"TeamJapan","away");var game=$scope.y;"top"===game.half?(game.batter=game.teams.away.lineup[game.batter.order],game.deck=game.teams.away.lineup[(game.batter.order+1)%9],game.hole=game.teams.away.lineup[(game.batter.order+2)%9]):game.pitcher=game.teams.away.positions.pitcher},$scope.sim=function(){$scope.proceedToGame(1,1)},$scope.seventh=function(){$scope.proceedToGame(7)},$scope.playball=function(){$scope.proceedToGame()},$scope.spectate=function(){$scope.proceedToGame(0,1)},$scope.proceedToGame=function(quickMode,spectateCpu){$scope.y=new Game;var game=$scope.y;game.humanControl=spectateCpu?"none":"home",game.quickMode=!!quickMode&&7!==quickMode;var field=window.location.hash?window.location.hash.slice(1):game.teams.home.name+Math.ceil(47*Math.random());if("undefined"!=typeof io&&(socket.game=game,$scope.socket=io("http://georgefu.info:64321",{reconnection:!1}),$scope.socketService=socket,socket.socket=$scope.socket,socket.start(field)),window.location.hash="#"+field,s2.y=game,bindMethods(),$(".blocking").remove(),"none"==game.humanControl&&game.quickMode){var n=0;Animator.console=!0,game.console=!0;do n++,game.simulateInput(function(callback){"function"==typeof callback&&callback()});while("end"!=game.stage&&500>n);Animator.console=game.console=!1,log("sim ended"),game.debugOut()}else if("none"==game.humanControl)var scalar=game.quickMode?.05:1,auto=setInterval(function(){"end"==game.stage&&clearInterval(auto),game.simulatePitchAndSwing(function(callback){game.quickMode?void 0:$scope.$apply(),$scope.updateFlightPath(callback)})},scalar*(game.field.hasRunnersOn()?Animator.TIME_FROM_SET+2e3:Animator.TIME_FROM_WINDUP+2e3));else if(7===quickMode&&void 0===spectateCpu){Animator.console=game.quickMode=game.console=!0;do game.simulateInput(function(callback){"function"==typeof callback&&callback()});while(game.inning<7);log("sim halted in 7th"),game.debugOut(),Animator.console=game.quickMode=game.console=!1,game.stage="pitch",game.half="top",game.humanControl="home"}"away"==game.humanControl&&game.simulateInput(function(callback){$scope.updateFlightPath(callback)}),"home"==game.humanControl&&($scope.showMessage=!0),quickMode&&7!==quickMode||Animator.loop.setTargetTimeOfDay(game.startTime.h,game.startTime.m)};var bindMethods=function(){var game=$scope.y;$scope.holdUpTimeouts=[],$scope.expandScoreboard=!1,$scope.updateFlightPath=Animator.updateFlightPath.bind($scope);var bat=$(".target .swing.stance-indicator"),showBat=function(event){if(game.humanBatting()){var offset=$(".target").offset(),relativeOffset={x:event.pageX-offset.left,y:200-(event.pageY-offset.top)},angle=game.setBatAngle(relativeOffset.x,relativeOffset.y);bat.css({top:200-relativeOffset.y+"px",left:relativeOffset.x+"px",transform:"rotate("+angle+"deg) rotateY("+("left"==game.batter.bats?0:-0)+"deg)"}),relativeOffset.x>200||relativeOffset.x<0||relativeOffset.y>200||relativeOffset.y<0?bat.hide():bat.show()}},glove=$(".target .glove.stance-indicator"),showGlove=function(event){if(game.humanPitching()){var offset=$(".target").offset(),relativeOffset={x:event.pageX-offset.left,y:200-(event.pageY-offset.top)};glove.css({top:200-relativeOffset.y+"px",left:relativeOffset.x+"px"}),relativeOffset.x>200||relativeOffset.x<0||relativeOffset.y>200||relativeOffset.y<0?glove.hide():glove.show()}};$scope.clickLineup=function(player){if(player.team.sub){var sub=player.team.sub;return player.team.sub=null,sub.substitute(player)}player.team.expanded=player.team.expanded==player?null:player},$scope.selectSubstitute=function(player){("home"!==game.humanControl||player.team===game.teams.home)&&("away"!==game.humanControl||player.team===game.teams.away)&&(player.team.sub=player.team.sub===player?null:player)},$scope.selectPitch=function(pitchName){"pitch"==game.stage&&(game.pitchInFlight=$.extend({},game.pitcher.pitching[pitchName]),game.pitchInFlight.name=pitchName,game.swingResult.looking=!0)},$scope.allowInput=!0,$scope.holdUp=function(){$(".input-area").click(),$scope.$apply()},game.startOpponentPitching=function(callback){$scope.updateFlightPath(callback)},$scope.indicate=function($event){if($scope.allowInput&&!game.pitcher.windingUp){game.humanPitching()&&($scope.allowInput=!1);var offset=$(".target").offset(),relativeOffset={x:$event.pageX-offset.left,y:200-($event.pageY-offset.top)};for(clearTimeout($scope.lastTimeout);$scope.holdUpTimeouts.length;)clearTimeout($scope.holdUpTimeouts.shift());$scope.showMessage=!1,game.receiveInput(relativeOffset.x,relativeOffset.y,function(callback){$scope.updateFlightPath(callback)})}},$scope.abbreviatePosition=function(position){return"e"==text.mode?{pitcher:"P",catcher:"C",first:"1B",second:"2B","short":"SS",third:"3B",left:"LF",center:"CF",right:"RF"}[position]:text.fielderShortName(position)},$scope.$watch("y.humanBatting()",function(){$scope.y.humanBatting()?$(".input-area").mousemove(showBat):($(".input-area").unbind("mousemove",showBat),bat.hide())}),$scope.$watch("y.humanPitching()",function(){$scope.y.humanPitching()?$(".input-area").mousemove(showGlove):($(".input-area").unbind("mousemove",showGlove),glove.hide())});({left:$("aside.image-panel.left"),right:$("aside.image-panel.right")})}};var SocketService=function(){var game,socket,Service=function(){},NO_OPERATION=function(){},animator=Baseball.service.Animator;return Service.prototype={socket:{},game:{},connected:!1,start:function(key){game=this.game,socket=this.socket,game.opponentService=this,this.connected=socket.connected,this.on(),socket.emit("register",key),socket.on("connect_failed reconnect_failed",function(){console.log("connection unavailable")})},on:function(){var giraffe=this;socket.on("register",this.register),socket.on("connect reconnect",function(){giraffe.connected=!0}),socket.on("disconnect",function(){giraffe.connected=!1}),socket.on("pitch",function(pitch){game.thePitch(0,0,NO_OPERATION,pitch);var scope=window.s;animator.updateFlightPath.bind(scope)()}),socket.on("swing",function(swing){game.theSwing(0,0,NO_OPERATION,swing);var scope=window.s;animator.updateFlightPath.bind(scope)(function(){swing.contact&&animator.animateFieldingTrajectory(game)})}),socket.on("partner_disconnect",function(){console.log("The opponent has disconnected"),game.opponentConnected=!1;var scope=window.s;scope.$digest()}),socket.on("partner_connect",function(){game.opponentConnected=!0;var scope=window.s;scope.$digest()}),socket.on("opponent_taking_field",function(){console.log("A challenger has appeared! Sending game data."),socket.emit("game_data",game.toData())}),socket.on("game_data",function(data){game.fromData(data);var scope=window.s;scope.$apply()}),socket.on("field_in_use",function(){game.opponentConnected=!1})},off:function(){socket.on("register",NO_OPERATION)},register:function(data){console.log(data),"away"===data&&(game.humanControl="away"),socket.on("register",NO_OPERATION)},emitPitch:function(pitch){socket.emit("pitch",pitch)},emitSwing:function(swing){socket.emit("swing",swing)},swing:function(){},pitch:function(){}},new Service};BattersDirective=function(){return{templateUrl:"public/html/views/directives/batters.html?cache="+cacheKey,transclude:!0}},BatteryDirective=function(){return{templateUrl:"public/html/views/directives/battery.html?cache="+cacheKey,transclude:!0}},FieldDirective=function(){return{templateUrl:"public/html/views/directives/field.html?cache="+cacheKey,transclude:!0}},RatingBlockDirective=function(){return{scope:{rating:"="},transclude:!0,templateUrl:"public/html/views/directives/ratingBlock.html?cache="+cacheKey,link:function(scope){}}},ScoreboardDirective=function(){return{scope:{game:"=",text:"="},templateUrl:"public/html/views/directives/scoreboard.html?cache="+cacheKey,link:function(scope){window.s2=scope,scope.t=scope.text,scope.y=scope.game}}};var app=angular.module("YakyuuAikoukai",["directives"]).service("socket",SocketService).controller("IndexController",["$scope","socket",IndexController]);app.config(function($interpolateProvider){$interpolateProvider.startSymbol("{{"),$interpolateProvider.endSymbol("}}")}),cacheKey=Math.floor(1500*Math.random()),angular.module("directives",[]).directive("scoreboard",ScoreboardDirective).directive("batters",BattersDirective).directive("battery",BatteryDirective).directive("field",FieldDirective).directive("ratingBlock",RatingBlockDirective);
//# sourceMappingURL=sourcemaps/application.min.js.map